import { useState, useEffect } from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';

/* -------------------------------------------------------------------------- */
/*                                TYPES                                       */
/* -------------------------------------------------------------------------- */

interface Correction {
  wrong: string;
  suggestions: string[];
  position?: number;
}

interface ToneSuggestion {
  current: string;
  suggestion: string;
  reason: string;
}

interface StyleSuggestion {
  current: string;
  suggestion: string;
  type: string;
}

interface StyleMixing {
  detected: boolean;
  recommendedStyle?: string;
  reason?: string;
  corrections?: Array<{
    current: string;
    suggestion: string;
    type: string;
  }>;
}

interface PunctuationIssue {
  issue: string;
  currentSentence: string;
  correctedSentence: string;
  explanation: string;
}

interface EuphonyImprovement {
  current: string;
  suggestions: string[];
  reason: string;
}

interface ContentAnalysis {
  contentType: string;
  description?: string;
  missingElements?: string[];
  suggestions?: string[];
}

/* -------------------------------------------------------------------------- */
/*                        PROMPT BUILDERS (EXACT COPY)                        */
/* -------------------------------------------------------------------------- */

const buildTonePrompt = (text: string, tone: string) => {
  const toneInstructions: Record<string, string> = {
    'formal': `ржЖржкржирж┐ ржПржХржЬржи ржмрж╛ржВрж▓рж╛ ржнрж╛рж╖рж╛ ржмрж┐рж╢рзЗрж╖ржЬрзНржЮ ржПржмржВ ржжрж╛ржкрзНрждрж░рж┐ржХ рж▓рзЗржЦрж╛рж░ ржкрж░рж╛ржорж░рзНрж╢ржжрж╛рждрж╛ред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **ржЖржирзБрж╖рзНржарж╛ржирж┐ржХ (Formal)** ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯОп **ржЖржирзБрж╖рзНржарж╛ржирж┐ржХ ржЯрзЛржирзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:**

рзз. **рж╕рж░рзНржмржирж╛ржо ржУ рж╕ржорзНржмрзЛржзржи:**
   - рждрзБржорж┐/рждрзБржЗ тЖТ ржЖржкржирж┐
   - рждрзЛржорж╛рж░/рждрзЛрж░ тЖТ ржЖржкржирж╛рж░
   - рждрзЛржорж╛ржХрзЗ/рждрзЛржХрзЗ тЖТ ржЖржкржирж╛ржХрзЗ
   - рждрзЛржорж░рж╛ тЖТ ржЖржкржирж╛рж░рж╛
   - ржнрж╛ржЗ/ржмржирзНржзрзБ тЖТ ржорж╣рзЛржжржпрж╝/ржорж╣рзЛржжржпрж╝рж╛, ржЬржирж╛ржм, рж╢рзНрж░ржжрзНржзрзЗржпрж╝

рзи. **ржХрзНрж░рж┐ржпрж╝рж╛ржкржж рж░рзВржкрж╛ржирзНрждрж░:**
   - ржХрж░рзЛ/ржХрж░ тЖТ ржХрж░рзБржи
   - ржмрж▓рзБржи/ржмрж▓ тЖТ ржмрж▓рзБржи
   - ржжрзЗржЦрзЛ/ржжрзЗржЦ тЖТ ржжрзЗржЦрзБржи
   - ржпрж╛ржУ/ржпрж╛ тЖТ ржпрж╛ржи
   - ржПрж╕рзЛ/ржЖржпрж╝ тЖТ ржЖрж╕рзБржи
   - ржЦрж╛ржУ/ржЦрж╛ тЖТ ржЦрж╛ржи
   - рж╢рзЛржирзЛ/рж╢рзЛржи тЖТ рж╢рзБржирзБржи

рзй. **ржЕржнрж┐ржмрзНржпржХрзНрждрж┐ ржкрж░рж┐ржмрж░рзНрждржи:**
   - ржзржирзНржпржмрж╛ржж тЖТ ржЖржирзНрждрж░рж┐ржХ ржзржирзНржпржмрж╛ржж ржЬрзНржЮрж╛ржкржи ржХрж░ржЫрж┐ / ржХрзГрждржЬрзНржЮрждрж╛ ржкрзНрж░ржХрж╛рж╢ ржХрж░ржЫрж┐
   - рж╕рж░рж┐/ржжрзБржГржЦрж┐ржд тЖТ ржЖржирзНрждрж░рж┐ржХржнрж╛ржмрзЗ ржжрзБржГржЦрж┐ржд / ржХрзНрж╖ржорж╛ржкрзНрж░рж╛рж░рзНржерзА
   - ржкрзНрж▓рж┐ржЬ тЖТ ржЕржирзБржЧрзНрж░рж╣ржкрзВрж░рзНржмржХ / ржжржпрж╝рж╛ ржХрж░рзЗ
   - ржУржХрзЗ/ржарж┐ржХ ржЖржЫрзЗ тЖТ рж╕ржорзНржоржд / ржпржерж╛ржпрже
   - ржЪрж╛ржЗ тЖТ ржкрзНрж░ржпрж╝рзЛржЬржи / ржЖржмрж╢рзНржпржХ / ржХрж╛ржорзНржп
   - ржкрж╛рж░ржм тЖТ рж╕ржХрзНрж╖ржо рж╣ржм / рж╕ржорж░рзНрже рж╣ржм
   - ржЬрж╛ржирж╛ржм тЖТ ржЕржмржЧржд ржХрж░ржм / ржЬрзНржЮрж╛ржд ржХрж░ржм

рзк. **ржмрж╛ржХрзНржп ржЧржаржи:**
   - рж╕ржВржХрзНрж╖рж┐ржкрзНржд рж░рзВржк ржПржбрж╝рж┐ржпрж╝рзЗ ржкрзВрж░рзНржг ржмрж╛ржХрзНржп ржмрзНржпржмрж╣рж╛рж░
   - "ржЖржорж┐ ржЪрж╛ржЗ" тЖТ "ржЖржорж╛рж░ ржкрзНрж░рждрзНржпрж╛рж╢рж╛/ржХрж╛ржоржирж╛"
   - "ржжрж░ржХрж╛рж░" тЖТ "ржкрзНрж░ржпрж╝рзЛржЬржи/ржЖржмрж╢рзНржпржХ"
   - ржХржерзНржп ржнрж╛рж╖рж╛ тЖТ рж▓рж┐ржЦрж┐ржд/ржЖржирзБрж╖рзНржарж╛ржирж┐ржХ ржнрж╛рж╖рж╛

рзл. **рж╢ржмрзНржж ржкрзНрж░рждрж┐рж╕рзНржерж╛ржкржи:**
   - ржПржЦржи тЖТ ржмрж░рзНрждржорж╛ржирзЗ
   - ржЖржЧрзЗ тЖТ ржкрзВрж░рзНржмрзЗ
   - ржкрж░рзЗ тЖТ ржкрж░ржмрж░рзНрждрзАрждрзЗ
   - ржЕржирзЗржХ тЖТ ржмрж╣рзБ / ржпржерзЗрж╖рзНржЯ
   - ржПржХржЯрзБ тЖТ ржХрж┐ржЮрзНржЪрж┐рзО / рж╕рж╛ржорж╛ржирзНржп
   - ржЦрзБржм тЖТ ржЕрждрзНржпржирзНржд / ржЕрждрж┐рж╢ржпрж╝`,

    'informal': `ржЖржкржирж┐ ржПржХржЬржи ржмрж╛ржВрж▓рж╛ ржнрж╛рж╖рж╛ ржмрж┐рж╢рзЗрж╖ржЬрзНржЮред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **ржЕржирж╛ржирзБрж╖рзНржарж╛ржирж┐ржХ (Informal)** ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯОп **ржЕржирж╛ржирзБрж╖рзНржарж╛ржирж┐ржХ ржЯрзЛржирзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:**

рзз. **рж╕рж░рзНржмржирж╛ржо ржУ рж╕ржорзНржмрзЛржзржи:**
   - ржЖржкржирж┐ тЖТ рждрзБржорж┐/рждрзБржЗ (context ржЕржирзБржпрж╛ржпрж╝рзА)
   - ржЖржкржирж╛рж░ тЖТ рждрзЛржорж╛рж░/рждрзЛрж░
   - ржЖржкржирж╛ржХрзЗ тЖТ рждрзЛржорж╛ржХрзЗ/рждрзЛржХрзЗ
   - ржорж╣рзЛржжржпрж╝ тЖТ ржнрж╛ржЗ/ржмржирзНржзрзБ/ржжрзЛрж╕рзНржд
   - рж╢рзНрж░ржжрзНржзрзЗржпрж╝ тЖТ ржкрзНрж░рж┐ржпрж╝

рзи. **ржХрзНрж░рж┐ржпрж╝рж╛ржкржж рж░рзВржкрж╛ржирзНрждрж░:**
   - ржХрж░рзБржи тЖТ ржХрж░рзЛ/ржХрж░
   - ржмрж▓рзБржи тЖТ ржмрж▓рзЛ/ржмрж▓
   - ржжрзЗржЦрзБржи тЖТ ржжрзЗржЦрзЛ/ржжрзЗржЦ
   - ржпрж╛ржи тЖТ ржпрж╛ржУ/ржпрж╛
   - ржЖрж╕рзБржи тЖТ ржПрж╕рзЛ/ржЖржпрж╝
   - рж╢рзБржирзБржи тЖТ рж╢рзЛржирзЛ/рж╢рзЛржи

рзй. **ржЕржнрж┐ржмрзНржпржХрзНрждрж┐ ржкрж░рж┐ржмрж░рзНрждржи:**
   - ржХрзГрждржЬрзНржЮрждрж╛ ржкрзНрж░ржХрж╛рж╢ ржХрж░ржЫрж┐ тЖТ ржерзНржпрж╛ржВржХрж╕/ржзржирзНржпржмрж╛ржж
   - ржХрзНрж╖ржорж╛ржкрзНрж░рж╛рж░рзНржерзА тЖТ рж╕рж░рж┐/ржорж╛ржл ржХрж░рзЛ
   - ржЕржирзБржЧрзНрж░рж╣ржкрзВрж░рзНржмржХ тЖТ ржкрзНрж▓рж┐ржЬ/ржПржХржЯрзБ
   - рж╕ржорзНржоржд тЖТ ржУржХрзЗ/ржарж┐ржХ ржЖржЫрзЗ/ржмрзЗрж╢
   - ржкрзНрж░ржпрж╝рзЛржЬржи тЖТ ржжрж░ржХрж╛рж░/рж▓рж╛ржЧржмрзЗ
   - рж╕ржХрзНрж╖ржо рж╣ржм тЖТ ржкрж╛рж░ржм

рзк. **ржмрж╛ржХрзНржп ржЧржаржи:**
   - ржЫрзЛржЯ, рж╕рж░рж▓ ржмрж╛ржХрзНржп ржмрзНржпржмрж╣рж╛рж░
   - ржХржерзНржп ржнрж╛рж╖рж╛рж░ ржзрж╛ржБржЪ
   - ржЬржЯрж┐рж▓ рж╢ржмрзНржж ржПржбрж╝рж┐ржпрж╝рзЗ рж╕рж╣ржЬ рж╢ржмрзНржж
   - "ржЖржорж╛рж░ ржкрзНрж░рждрзНржпрж╛рж╢рж╛" тЖТ "ржЖржорж┐ ржЪрж╛ржЗ"

рзл. **рж╢ржмрзНржж ржкрзНрж░рждрж┐рж╕рзНржерж╛ржкржи:**
   - ржмрж░рзНрждржорж╛ржирзЗ тЖТ ржПржЦржи
   - ржкрзВрж░рзНржмрзЗ тЖТ ржЖржЧрзЗ
   - ржкрж░ржмрж░рзНрждрзАрждрзЗ тЖТ ржкрж░рзЗ
   - ржЕрждрзНржпржирзНржд тЖТ ржЦрзБржм/ржЕржирзЗржХ
   - ржХрж┐ржЮрзНржЪрж┐рзО тЖТ ржПржХржЯрзБ
   - ржпржерзЗрж╖рзНржЯ тЖТ ржЕржирзЗржХ/ржмрзЗрж╢рж┐`,

    'professional': `ржЖржкржирж┐ ржПржХржЬржи ржмрзНржпржмрж╕рж╛ржпрж╝рж┐ржХ ржпрзЛржЧрж╛ржпрзЛржЧ ржмрж┐рж╢рзЗрж╖ржЬрзНржЮред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **ржкрзЗрж╢рж╛ржжрж╛рж░ (Professional)** ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯОп **ржкрзЗрж╢рж╛ржжрж╛рж░ ржЯрзЛржирзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:**

рзз. **рж╕рзНржкрж╖рзНржЯрждрж╛ ржУ рж╕ржВржХрзНрж╖рж┐ржкрзНрждрждрж╛:**
   - ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж╢ржмрзНржж ржмрж╛ржж ржжрж┐ржи
   - рж╕рж░рж╛рж╕рж░рж┐ ржмржХрзНрждржмрзНржп ржкрзНрж░ржХрж╛рж╢
   - ржЬржЯрж┐рж▓ ржмрж╛ржХрзНржп рж╕рж╣ржЬ ржХрж░рзБржи
   - ржПржХ ржмрж╛ржХрзНржпрзЗ ржПржХржЯрж┐ ржзрж╛рж░ржгрж╛

рзи. **ржЖрждрзНржоржмрж┐рж╢рзНржмрж╛рж╕рзА ржнрж╛рж╖рж╛:**
   - ржоржирзЗ рж╣ржпрж╝ тЖТ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рж╛ рж╣ржпрж╝ / ржкрзНрж░рждрзАржпрж╝ржорж╛ржи рж╣ржпрж╝
   - рж╣ржпрж╝рждрзЛ тЖТ рж╕ржорзНржнрж╛ржмрзНржп / ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд
   - ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржм тЖТ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░ржм / рж╕ржорзНржкржирзНржи ржХрж░ржм
   - рж╕ржорзНржнржмржд тЖТ ржкрзНрж░рждрзНржпрж╛рж╢рж┐рждржнрж╛ржмрзЗ

рзй. **рж╕ржХрзНрж░рж┐ржпрж╝ ржмрж╛ржХрзНржп:**
   - ржХрж╛ржЬржЯрж┐ ржХрж░рж╛ рж╣ржмрзЗ тЖТ ржЖржорж░рж╛ ржХрж╛ржЬржЯрж┐ ржХрж░ржм
   - рж╕рж┐ржжрзНржзрж╛ржирзНржд ржирзЗржУржпрж╝рж╛ рж╣ржпрж╝рзЗржЫрзЗ тЖТ ржЖржорж░рж╛ рж╕рж┐ржжрзНржзрж╛ржирзНржд ржирж┐ржпрж╝рзЗржЫрж┐
   - ржЬрж╛ржирж╛ржирзЛ рж╣ржЪрзНржЫрзЗ тЖТ ржЬрж╛ржирж╛ржЪрзНржЫрж┐

рзк. **ржкрзЗрж╢рж╛ржжрж╛рж░ рж╢ржмрзНржжржнрж╛ржгрзНржбрж╛рж░:**
   - рж╕ржорж╕рзНржпрж╛ тЖТ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ / ржмрж┐рж╖ржпрж╝
   - ржмрзНржпрж░рзНржерждрж╛ тЖТ рж╢рж┐ржХрзНрж╖ржгрзАржпрж╝ ржЕржнрж┐ржЬрзНржЮрждрж╛
   - ржжрж╛ржо тЖТ ржмрж┐ржирж┐ржпрж╝рзЛржЧ / ржорзВрж▓рзНржп
   - ржХрж╛ржЬ тЖТ ржкрзНрж░ржХрж▓рзНржк / ржХрж╛рж░рзНржпржХрзНрж░ржо
   - ржЯрж╛ржХрж╛ тЖТ ржЕрж░рзНрже / ржмрж╛ржЬрзЗржЯ

рзл. **ржиржорзНрж░ ржХрж┐ржирзНрждрзБ ржжрзГржврж╝:**
   - ржЖржкржирж╛ржХрзЗ ржХрж░рждрзЗ рж╣ржмрзЗ тЖТ ржЖржкржирж╛рж░ ржмрж┐ржмрзЗржЪржирж╛рж░ ржЬржирзНржп
   - ржПржЯрж╛ ржнрзБрж▓ тЖТ ржПржЯрж┐ ржкрзБржирж░рзНржмрж┐ржмрзЗржЪржирж╛ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ
   - ржкрж╛рж░ржм ржирж╛ тЖТ ржмрж┐ржХрж▓рзНржк ржкржжрзНржзрждрж┐ ржкрзНрж░рж╕рзНрждрж╛ржм ржХрж░ржЫрж┐`,

    'friendly': `ржЖржкржирж┐ ржПржХржЬржи ржмрж╛ржВрж▓рж╛ ржнрж╛рж╖рж╛ ржмрж┐рж╢рзЗрж╖ржЬрзНржЮред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **ржмржирзНржзрзБрждрзНржмржкрзВрж░рзНржг (Friendly)** ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯОп **ржмржирзНржзрзБрждрзНржмржкрзВрж░рзНржг ржЯрзЛржирзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:**

рзз. **ржЙрж╖рзНржг рж╕ржорзНржмрзЛржзржи:**
   - ржорж╣рзЛржжржпрж╝ тЖТ ржкрзНрж░рж┐ржпрж╝ ржмржирзНржзрзБ / рж╣рзНржпрж╛рж▓рзЛ
   - ржЬржирж╛ржм тЖТ ржнрж╛ржЗ/ржЖржкрзБ/ржжрж╛ржжрж╛/ржжрж┐ржжрж┐
   - рж╢рзНрж░ржжрзНржзрзЗржпрж╝ тЖТ ржкрзНрж░рж┐ржпрж╝

рзи. **ржЖржмрзЗржЧржкрзВрж░рзНржг рж╢ржмрзНржж:**
   - ржнрж╛рж▓рзЛ тЖТ ржжрж╛рж░рзБржг! / ржЕрж╕рж╛ржзрж╛рж░ржг! / ржЪржорзОржХрж╛рж░!
   - ржзржирзНржпржмрж╛ржж тЖТ ржЕржирзЗржХ ржзржирзНржпржмрж╛ржж! / ржерзНржпрж╛ржВржХрж╕!
   - рж╣рзНржпрж╛ржБ тЖТ ржЕржмрж╢рзНржпржЗ! / ржЬрж┐ ржЬрж┐! / рж╣рзНржпрж╛ржБ рж╣рзНржпрж╛ржБ!

рзй. **ржЗрждрж┐ржмрж╛ржЪржХ ржнрж╛рж╖рж╛:**
   - рж╕ржорж╕рзНржпрж╛ ржирзЗржЗ тЖТ ржХрзЛржи ржмрзНржпрж╛ржкрж╛рж░ ржирж╛!
   - ржжрзБржГржЦрж┐ржд тЖТ рж╕рж░рж┐! / ржХрзНрж╖ржорж╛ ржХрж░рзЛ!
   - ржкрж╛рж░ржм тЖТ ржЕржмрж╢рзНржпржЗ ржкрж╛рж░ржм!
   - ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржм тЖТ ржХрж░рзЗржЗ ржжрзЗржЦрж╛ржм!

рзк. **ржкрзНрж░рж╢рзНржирж╕рзВржЪржХ ржмрж╛ржХрзНржп:**
   - ржЬрж╛ржирж╛ржмрзЗржи тЖТ ржЬрж╛ржирж╛ржмрзЗ ржХрж┐?
   - ржХрж░рзБржи тЖТ ржХрж░ржмрзЗ ржирж╛?
   - ржмрж▓рзБржи тЖТ ржмрж▓рзЛ ржирж╛!

рзл. **ржЕржирж╛ржирзБрж╖рзНржарж╛ржирж┐ржХ ржкрзНрж░ржХрж╛рж╢:**
   - ржХрзЗржоржи ржЖржЫрзЗржи тЖТ ржХрзЗржоржи ржЖржЫрзЛ? / ржХрзА ржЦржмрж░?
   - ржмрж┐ржжрж╛ржпрж╝ тЖТ ржкрж░рзЗ ржжрзЗржЦрж╛ рж╣ржмрзЗ! / ржЯрж╛ржЯрж╛!
   - ржЕржкрзЗржХрзНрж╖рж╛ржпрж╝ ржЖржЫрж┐ тЖТ wait ржХрж░ржЫрж┐!`,

    'respectful': `ржЖржкржирж┐ ржПржХржЬржи ржмрж╛ржВрж▓рж╛ ржнрж╛рж╖рж╛ ржмрж┐рж╢рзЗрж╖ржЬрзНржЮ ржПржмржВ рж╢рж┐рж╖рзНржЯрж╛ржЪрж╛рж░ ржкрж░рж╛ржорж░рзНрж╢ржжрж╛рждрж╛ред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **рж╕ржорзНржорж╛ржиржЬржиржХ (Respectful)** ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯОп **рж╕ржорзНржорж╛ржиржЬржиржХ ржЯрзЛржирзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:**

рзз. **рж╕ржорзНржорж╛ржирж╕рзВржЪржХ рж╕ржорзНржмрзЛржзржи:**
   - ржирж╛ржо тЖТ рж╢рзНрж░ржжрзНржзрзЗржпрж╝/ржорж╛ржиржирзАржпрж╝/ржкрзВржЬржирзАржпрж╝ + ржирж╛ржо + рж╕рж╛рж╣рзЗржм/ржорзНржпрж╛ржбрж╛ржо
   - ржЖржкржирж┐ тЖТ ржЖржкржирж┐ (рж╕рж░рзНржмржжрж╛)
   - рж╕рзНржпрж╛рж░/ржорзНржпрж╛ржо тЖТ ржорж╣рзЛржжржпрж╝/ржорж╣рзЛржжржпрж╝рж╛

рзи. **ржмрж┐ржирзАржд ржЕржирзБрж░рзЛржз:**
   - ржХрж░рзБржи тЖТ ржХрж░рж▓рзЗ ржмрж╛ржзрж┐ржд рж╣ржм / ржХрж░рж▓рзЗ ржХрзГрждрж╛рж░рзНрже рж╣ржм
   - ржжрж┐ржи тЖТ ржжрж┐рж▓рзЗ ржЕржирзБржЧрзГрж╣рзАржд рж╣ржм
   - ржмрж▓рзБржи тЖТ ржЬрж╛ржирж╛рж▓рзЗ ржХрзГрждржЬрзНржЮ ржерж╛ржХржм
   - ржЪрж╛ржЗ тЖТ ржкрзНрж░рж╛рж░рзНржержирж╛ ржХрж░рж┐ / ржЕржирзБрж░рзЛржз ржХрж░ржЫрж┐ / ржирж┐ржмрзЗржжржи ржХрж░ржЫрж┐

рзй. **ржиржорзНрж░ ржкрзНрж░ржХрж╛рж╢:**
   - ржЖржорж┐ ржоржирзЗ ржХрж░рж┐ тЖТ ржЖржорж╛рж░ ржмрж┐ржирзАржд ржоржд
   - ржЖржорж╛рж░ ржорждрзЗ тЖТ ржЖржкржирж╛рж░ ржмрж┐ржмрзЗржЪржирж╛ржпрж╝ рж░рж╛ржЦржЫрж┐
   - ржЬрж╛ржирж╛ржЪрзНржЫрж┐ тЖТ рж╕ржмрж┐ржиржпрж╝рзЗ ржЬрзНржЮрж╛ржд ржХрж░ржЫрж┐
   - ржмрж▓ржЫрж┐ тЖТ ржирж┐ржмрзЗржжржи ржХрж░ржЫрж┐

рзк. **рж╢рзНрж░ржжрзНржзрж╛рж╕рзВржЪржХ рж╢ржмрзНржж:**
   - ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ тЖТ ржЕржирзБржЧрзНрж░рж╣ржкрзВрж░рзНржмржХ / ржХрзГржкрж╛ ржХрж░рзЗ
   - ржжржпрж╝рж╛ ржХрж░рзЗ тЖТ ржжржпрж╝рж╛ржкрж░ржмрж╢ рж╣ржпрж╝рзЗ
   - ржпржжрж┐ рж╕ржорзНржнржм рж╣ржпрж╝ тЖТ ржпржжрж┐ ржЖржкржирж╛рж░ ржЕржирзБржХрзВрж▓ рж╣ржпрж╝

рзл. **рж╕ржорж╛ржкржирзА:**
   - ржзржирзНржпржмрж╛ржж тЖТ рж╕рж╢рзНрж░ржжрзНржз ржзржирзНржпржмрж╛ржж / ржХрзГрждржЬрзНржЮрждрж╛ рж╕рж╣
   - ржмрж┐ржжрж╛ржпрж╝ тЖТ ржмрж┐ржирзАржд ржмрж┐ржжрж╛ржпрж╝ / рж╢рзНрж░ржжрзНржзрж╛рж╕рж╣`,

    'persuasive': `ржЖржкржирж┐ ржПржХржЬржи ржорж╛рж░рзНржХрзЗржЯрж┐ржВ ржУ ржХржорж┐ржЙржирж┐ржХрзЗрж╢ржи ржмрж┐рж╢рзЗрж╖ржЬрзНржЮред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **ржкрзНрж░ржнрж╛ржмрж╢рж╛рж▓рзА (Persuasive)** ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯОп **ржкрзНрж░ржнрж╛ржмрж╢рж╛рж▓рзА ржЯрзЛржирзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:**

рзз. **рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА рж╢ржмрзНржж:**
   - ржнрж╛рж▓рзЛ тЖТ ржЕрж╕рж╛ржзрж╛рж░ржг / ржЕрждрзБрж▓ржирзАржпрж╝ / ржЕржнрзВрждржкрзВрж░рзНржм
   - рж╕рзБржмрж┐ржзрж╛ тЖТ ржмрж┐рж╢рзЗрж╖ рж╕рзБржпрзЛржЧ / ржПржХржЪрзЗржЯрж┐ржпрж╝рж╛ рж╕рзБржмрж┐ржзрж╛
   - ржкржгрзНржп тЖТ рж╕ржорж╛ржзрж╛ржи / ржЙржжрзНржнрж╛ржмржи
   - ржХрж┐ржирзБржи тЖТ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи / ржЕрж░рзНржЬржи ржХрж░рзБржи

рзи. **ржЬрж░рзБрж░рж┐рждрж╛ рждрзИрж░рж┐:**
   - ржХрж░рзБржи тЖТ ржПржЦржиржЗ ржХрж░рзБржи!
   - ржкрж░рзЗ тЖТ ржЖржЬржЗ!
   - ржЪрж┐ржирзНрждрж╛ ржХрж░рзБржи тЖТ ржПржЗ ржорзБрж╣рзВрж░рзНрждрзЗ рж╕рж┐ржжрзНржзрж╛ржирзНржд ржирж┐ржи!
   - рж╕рзАржорж┐ржд рж╕ржоржпрж╝ / рж╢рзЗрж╖ рж╕рзБржпрзЛржЧ

рзй. **ржЗрждрж┐ржмрж╛ржЪржХ ржлрж▓рж╛ржлрж▓:**
   - ржкрж╛ржмрзЗржи тЖТ ржирж┐рж╢рзНржЪрж┐рждржнрж╛ржмрзЗ ржкрж╛ржмрзЗржи
   - рж╣рждрзЗ ржкрж╛рж░рзЗ тЖТ ржЕржмрж╢рзНржпржЗ рж╣ржмрзЗ
   - рж╕ржорзНржнржмржд тЖТ ржкрзНрж░ржорж╛ржгрж┐рждржнрж╛ржмрзЗ
   - ржЪрзЗрж╖рзНржЯрж╛ тЖТ ржЧрзНржпрж╛рж░рж╛ржирзНржЯрж┐

рзк. **ржЖржмрзЗржЧ ржУ ржпрзБржХрзНрждрж┐:**
   - ржХрж▓рзНржкржирж╛ ржХрж░рзБржи...
   - ржнрж╛ржмрзБржи ржПржХржмрж╛рж░...
   - ржкрзНрж░ржорж╛ржгрж┐ржд ржлрж▓рж╛ржлрж▓
   - рж╣рж╛ржЬрж╛рж░рзЛ ржорж╛ржирзБрж╖рзЗрж░ ржкржЫржирзНржж

рзл. **Call-to-Action:**
   - ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рзБржи тЖТ ржПржЦржиржЗ ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рзБржи!
   - ржжрзЗржЦрзБржи тЖТ ржорж┐рж╕ ржХрж░ржмрзЗржи ржирж╛!
   - ржЬрж╛ржирзБржи тЖТ ржЖржЬржЗ ржЬрж╛ржирзБржи ржУ рж╢рзБрж░рзБ ржХрж░рзБржи!`,

    'neutral': `ржЖржкржирж┐ ржПржХржЬржи рж╕ржВржмрж╛ржж рж▓рзЗржЦржХ ржУ рждржерзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржХред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **ржирж┐рж░ржкрзЗржХрзНрж╖ (Neutral)** ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯОп **ржирж┐рж░ржкрзЗржХрзНрж╖ ржЯрзЛржирзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:**

рзз. **ржмрж╕рзНрждрзБржирж┐рж╖рзНржа ржнрж╛рж╖рж╛:**
   - ржЖржорж┐ ржоржирзЗ ржХрж░рж┐ тЖТ рждржерзНржп ржЕржирзБржпрж╛ржпрж╝рзА
   - ржЖржорж╛рж░ ржорждрзЗ тЖТ ржкрж░рзНржпржмрзЗржХрзНрж╖ржгрзЗ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝
   - ржЕржмрж╢рзНржпржЗ тЖТ рж╕ржорзНржнрж╛ржмржирж╛ рж░ржпрж╝рзЗржЫрзЗ
   - ржирж┐рж╢рзНржЪрж┐ржд тЖТ ржкрзНрж░рж╛ржкрзНржд рждржерзНржпржорждрзЗ

рзи. **ржЖржмрзЗржЧржорзБржХрзНржд рж╢ржмрзНржж:**
   - ржжрж╛рж░рзБржг/ржЪржорзОржХрж╛рж░ тЖТ ржЙрж▓рзНрж▓рзЗржЦржпрзЛржЧрзНржп / рж▓ржХрзНрж╖ржгрзАржпрж╝
   - ржЦрж╛рж░рж╛ржк/ржнржпрж╝ржВржХрж░ тЖТ ржирзЗрждрж┐ржмрж╛ржЪржХ / ржкрзНрж░рждрж┐ржХрзВрж▓
   - ржнрж╛рж▓рзЛ тЖТ ржЗрждрж┐ржмрж╛ржЪржХ / ржЕржирзБржХрзВрж▓
   - рж╕рзБржирзНржжрж░ тЖТ ржпржерж╛ржпрже / ржЙржкржпрзБржХрзНржд

рзй. **рждрзГрждрзАржпрж╝ ржкрзБрж░рзБрж╖:**
   - ржЖржорж┐ ржжрзЗржЦрзЗржЫрж┐ тЖТ ржкрж░рж┐рж▓ржХрзНрж╖рж┐ржд рж╣ржпрж╝рзЗржЫрзЗ
   - ржЖржорж░рж╛ ржмрж▓рждрзЗ ржкрж╛рж░рж┐ тЖТ ржмрж▓рж╛ ржпрж╛ржпрж╝
   - рждрзБржорж┐/ржЖржкржирж┐ тЖТ рж╕ржВрж╢рзНрж▓рж┐рж╖рзНржЯ ржмрзНржпржХрзНрждрж┐

рзк. **рж╕рзВрждрзНрж░ ржЙрж▓рзНрж▓рзЗржЦ:**
   - ржЬрж╛ржирж╛ ржЧрзЗржЫрзЗ тЖТ рж╕рзВрждрзНрж░ржорждрзЗ ржЬрж╛ржирж╛ ржпрж╛ржпрж╝
   - рж╢рзЛржирж╛ ржпрж╛ржЪрзНржЫрзЗ тЖТ ржкрзНрж░рж╛ржкрзНржд рждржерзНржпрж╛ржирзБржпрж╛ржпрж╝рзА
   - ржоржирзЗ рж╣ржЪрзНржЫрзЗ тЖТ ржкрж░рзНржпрж╛рж▓рзЛржЪржирж╛ржпрж╝ ржкрзНрж░рждрзАржпрж╝ржорж╛ржи

рзл. **ржнрж╛рж░рж╕рж╛ржорзНржпржкрзВрж░рзНржг ржмрж┐ржмрзГрждрж┐:**
   - ржПржХржжрж┐ржХрзЗ... ржЕржирзНржпржжрж┐ржХрзЗ...
   - ржпржжрж┐ржУ... рждржерж╛ржкрж┐...
   - ржЗрждрж┐ржмрж╛ржЪржХ ржУ ржирзЗрждрж┐ржмрж╛ржЪржХ ржЙржнржпрж╝ ржжрж┐ржХ`,

    'academic': `ржЖржкржирж┐ ржПржХржЬржи ржЧржмрзЗрж╖ржХ ржУ рж╢рж┐ржХрзНрж╖рж╛ржмрж┐ржжред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **рж╢рж┐ржХрзНрж╖рж╛ржорзВрж▓ржХ/ржПржХрж╛ржбрзЗржорж┐ржХ (Academic)** ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯОп **ржПржХрж╛ржбрзЗржорж┐ржХ ржЯрзЛржирзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп:**

рзз. **ржкрж░рж┐ржнрж╛рж╖рж╛ ржмрзНржпржмрж╣рж╛рж░:**
   - ржжрзЗржЦрж╛ тЖТ ржкрж░рзНржпржмрзЗржХрзНрж╖ржг ржХрж░рж╛
   - ржмрзЛржЭрж╛ тЖТ ржЕржирзБржзрж╛ржмржи ржХрж░рж╛ / ржЙржкрж▓ржмрзНржзрж┐ ржХрж░рж╛
   - ржЬрж╛ржирж╛ тЖТ ржЕржмржЧржд рж╣ржУржпрж╝рж╛ / ржЬрзНржЮрж╛ржд рж╣ржУржпрж╝рж╛
   - ржоржирзЗ рж╣ржпрж╝ тЖТ ржкрзНрж░рждрзАржпрж╝ржорж╛ржи рж╣ржпрж╝

рзи. **рждрзГрждрзАржпрж╝ ржкрзБрж░рзБрж╖ ржмрзНржпржмрж╣рж╛рж░:**
   - ржЖржорж┐ ржжрзЗржЦрзЗржЫрж┐ тЖТ ржЧржмрзЗрж╖ржгрж╛ржпрж╝ ржкрж░рж┐рж▓ржХрзНрж╖рж┐ржд рж╣ржпрж╝рзЗржЫрзЗ
   - ржЖржорж░рж╛ ржмрж▓рждрзЗ ржкрж╛рж░рж┐ тЖТ ржЕржирзБржорж╛ржи ржХрж░рж╛ ржпрж╛ржпрж╝
   - ржЖржорж┐ ржоржирзЗ ржХрж░рж┐ тЖТ ржкрж░рзНржпрж╛рж▓рзЛржЪржирж╛ржпрж╝ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝

рзй. **ржЬржЯрж┐рж▓ ржмрж╛ржХрзНржп ржЧржаржи:**
   - ржХрж╛рж░ржг-ржлрж▓рж╛ржлрж▓ рж╕ржорзНржкрж░рзНржХ рж╕рзНржкрж╖рзНржЯ
   - ржпрзМржХрзНрждрж┐ржХ ржЕржЧрзНрж░ржЧрждрж┐
   - рж╕ржВржпрзЛржЬржХ рж╢ржмрзНржж: ржЕрждржПржм, рж╕рзБрждрж░рж╛ржВ, ржлрж▓рж╕рзНржмрж░рзВржк, ржкрж░рж┐ржгрж╛ржорзЗ

рзк. **ржПржХрж╛ржбрзЗржорж┐ржХ рж╢ржмрзНржжржнрж╛ржгрзНржбрж╛рж░:**
   - ржЧржмрзЗрж╖ржгрж╛ ржкрзНрж░ржХрж╛рж╢ ржХрж░рзЗ
   - ржкрзВрж░рзНржмржмрж░рзНрждрзА ржЧржмрзЗрж╖ржгрж╛ ржЕржирзБржпрж╛ржпрж╝рзА
   - ржПржЗ ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯрзЗ
   - ржЙрж▓рзНрж▓рзЗржЦржпрзЛржЧрзНржп ржпрзЗ
   - ржмрж┐рж╢рзНрж▓рзЗрж╖ржгрзЗ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝

рзл. **рж╕рзВрждрзНрж░ ржУ рждржерзНржпрж╕рзВрждрзНрж░:**
   - ржЕржорзБржХ (рзирзжрзирзй) ржПрж░ ржорждрзЗ
   - ржЧржмрзЗрж╖ржгрж╛рж▓ржмрзНржз ржлрж▓рж╛ржлрж▓ ржкрзНрж░ржорж╛ржг ржХрж░рзЗ
   - рждрж╛рждрзНрждрзНржмрж┐ржХ ржХрж╛ржарж╛ржорзЛ ржЕржирзБржпрж╛ржпрж╝рзА`
  };

  const toneDescriptions: Record<string, string> = {
    'formal': 'ржЖржирзБрж╖рзНржарж╛ржирж┐ржХ', 'informal': 'ржЕржирж╛ржирзБрж╖рзНржарж╛ржирж┐ржХ', 'professional': 'ржкрзЗрж╢рж╛ржжрж╛рж░',
    'friendly': 'ржмржирзНржзрзБрждрзНржмржкрзВрж░рзНржг', 'respectful': 'рж╕ржорзНржорж╛ржиржЬржиржХ', 'persuasive': 'ржкрзНрж░ржнрж╛ржмрж╢рж╛рж▓рзА',
    'neutral': 'ржирж┐рж░ржкрзЗржХрзНрж╖', 'academic': 'рж╢рж┐ржХрзНрж╖рж╛ржорзВрж▓ржХ'
  };

  return `${toneInstructions[tone]}

ЁЯУЭ **ржмрж┐рж╢рзНрж▓рзЗрж╖ржгрзЗрж░ ржЬржирзНржп ржЯрзЗржХрзНрж╕ржЯ:**
"${text}"

ЁЯУЛ **ржЖржкржирж╛рж░ ржХрж╛ржЬ:**
1. ржЯрзЗржХрзНрж╕ржЯрзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ рж╢ржмрзНржж ржУ ржмрж╛ржХрзНржпрж╛ржВрж╢ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржи
2. ржпрзЗрж╕ржм рж╢ржмрзНржж/ржмрж╛ржХрзНржпрж╛ржВрж╢ "${toneDescriptions[tone]}" ржЯрзЛржирзЗ ржирзЗржЗ рж╕рзЗржЧрзБрж▓рзЛ ржЪрж┐рж╣рзНржирж┐ржд ржХрж░рзБржи
3. ржкрзНрж░рждрж┐ржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ рж╕рзБржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж╛рж░ржг ржжрж┐ржи
4. рж╢рзБржзрзБржорж╛рждрзНрж░ ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржкрж░рж┐ржмрж░рзНрждржи рж╕рж╛ржЬрзЗрж╕рзНржЯ ржХрж░рзБржи, ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржкрж░рж┐ржмрж░рзНрждржи ржПржбрж╝рж┐ржпрж╝рзЗ ржЪрж▓рзБржи

тЪая╕П **рж╕рждрж░рзНржХрждрж╛:**
- рж╢ржмрзНржжржЯрж┐ ржЯрзЗржХрзНрж╕ржЯрзЗ рж╣рзБржмрж╣рзБ ржпрзЗржнрж╛ржмрзЗ ржЖржЫрзЗ рж╕рзЗржнрж╛ржмрзЗржЗ "current" ржлрж┐рж▓рзНржбрзЗ ржжрж┐ржи
- ржПржХржЗ рж╢ржмрзНржж ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржерж╛ржХрж▓рзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржЖрж▓рж╛ржжрж╛ржнрж╛ржмрзЗ ржжрж┐ржи
- ржпржжрж┐ ржХрзЛржи ржкрж░рж┐ржмрж░рзНрждржи ржкрзНрж░ржпрж╝рзЛржЬржи ржирж╛ рж╣ржпрж╝ рждрж╛рж╣рж▓рзЗ ржЦрж╛рж▓рж┐ array ржжрж┐ржи

ЁЯУд **Response Format (рж╢рзБржзрзБржорж╛рждрзНрж░ valid JSON):**
{
  "toneConversions": [
    {
      "current": "ржмрж░рзНрждржорж╛ржи рж╢ржмрзНржж/ржмрж╛ржХрзНржпрж╛ржВрж╢ (рж╣рзБржмрж╣рзБ ржЯрзЗржХрзНрж╕ржЯ ржерзЗржХрзЗ)",
      "suggestion": "${toneDescriptions[tone]} ржЯрзЛржирзЗ рж░рзВржкрж╛ржирзНрждрж░рж┐ржд рж░рзВржк",
      "reason": "ржХрзЗржи ржПржЗ ржкрж░рж┐ржмрж░рзНрждржи ${toneDescriptions[tone]} ржЯрзЛржирзЗрж░ ржЬржирзНржп ржкрзНрж░ржпрж╝рзЛржЬржи"
    }
  ]
}`;
};

const buildStylePrompt = (text: string, style: string) => {
  const styleInstructions: Record<string, string> = {
    'sadhu': `ржЖржкржирж┐ ржПржХржЬржи ржмрж╛ржВрж▓рж╛ ржмрзНржпрж╛ржХрж░ржг ржмрж┐рж╢рзЗрж╖ржЬрзНржЮ ржПржмржВ ржнрж╛рж╖рж╛рждрждрзНрждрзНржмржмрж┐ржжред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **рж╕рж╛ржзрзБ рж░рзАрждрж┐**рждрзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯУЪ **рж╕рж╛ржзрзБ рж░рзАрждрж┐рж░ рж╕ржорзНржкрзВрж░рзНржг ржирж┐ржпрж╝ржорж╛ржмрж▓рзА:**

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯФд рзз. ржХрзНрж░рж┐ржпрж╝рж╛ржкржж рж░рзВржкрж╛ржирзНрждрж░ (рж╕ржмржЪрзЗржпрж╝рзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг)
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

ЁЯУМ **ржмрж░рзНрждржорж╛ржи ржХрж╛рж▓ (Present Tense):**

| ржЪрж▓рж┐ржд | рж╕рж╛ржзрзБ |
|------|------|
| ржХрж░ржЫрж┐ | ржХрж░рж┐рждрзЗржЫрж┐ |
| ржХрж░ржЫ | ржХрж░рж┐рждрзЗржЫ |
| ржХрж░ржЫрзЗ | ржХрж░рж┐рждрзЗржЫрзЗ |
| ржХрж░ржЫрзЗржи | ржХрж░рж┐рждрзЗржЫрзЗржи |
| ржЦрж╛ржЪрзНржЫрж┐ | ржЦрж╛ржЗрждрзЗржЫрж┐ |
| ржпрж╛ржЪрзНржЫрж┐ | ржпрж╛ржЗрждрзЗржЫрж┐ |
| ржжрзЗржЦржЫрж┐ | ржжрзЗржЦрж┐рждрзЗржЫрж┐ |
| ржмрж▓ржЫрж┐ | ржмрж▓рж┐рждрзЗржЫрж┐ |
| рж╢рзБржиржЫрж┐ | рж╢рзБржирж┐рждрзЗржЫрж┐ |
| ржкржбрж╝ржЫрж┐ | ржкржбрж╝рж┐рждрзЗржЫрж┐ |
| рж▓рж┐ржЦржЫрж┐ | рж▓рж┐ржЦрж┐рждрзЗржЫрж┐ |
| ржзрж░ржЫрж┐ | ржзрж░рж┐рждрзЗржЫрж┐ |
| ржЪрж▓ржЫрж┐ | ржЪрж▓рж┐рждрзЗржЫрж┐ |
| рж╣ржЪрзНржЫрж┐ | рж╣ржЗрждрзЗржЫрж┐ |
| ржЖрж╕ржЫрж┐ | ржЖрж╕рж┐рждрзЗржЫрж┐ |
| ржирж┐ржЪрзНржЫрж┐ | рж▓ржЗрждрзЗржЫрж┐ |
| ржжрж┐ржЪрзНржЫрж┐ | ржжрж┐рждрзЗржЫрж┐ |
| рж╢рж┐ржЦржЫрж┐ | рж╢рж┐ржЦрж┐рждрзЗржЫрж┐ |

ЁЯУМ **ржЕрждрзАржд ржХрж╛рж▓ (Past Tense):**

| ржЪрж▓рж┐ржд | рж╕рж╛ржзрзБ |
|------|------|
| ржХрж░рзЗржЫрж┐ | ржХрж░рж┐ржпрж╝рж╛ржЫрж┐ |
| ржХрж░рзЗржЫ | ржХрж░рж┐ржпрж╝рж╛ржЫ |
| ржХрж░рзЗржЫрзЗ | ржХрж░рж┐ржпрж╝рж╛ржЫрзЗ |
| ржХрж░рзЗржЫрж┐рж▓ | ржХрж░рж┐ржпрж╝рж╛ржЫрж┐рж▓ |
| ржХрж░рзЗржЫрж┐рж▓рж╛ржо | ржХрж░рж┐ржпрж╝рж╛ржЫрж┐рж▓рж╛ржо |
| ржХрж░рзЗржЫрж┐рж▓рзЗржи | ржХрж░рж┐ржпрж╝рж╛ржЫрж┐рж▓рзЗржи |
| ржЧрж┐ржпрж╝рзЗржЫрж┐ | ржЧрж┐ржпрж╝рж╛ржЫрж┐ |
| ржЧрзЗржЫрж┐ | ржЧрж┐ржпрж╝рж╛ржЫрж┐ |
| ржжрж┐ржпрж╝рзЗржЫрж┐ | ржжрж┐ржпрж╝рж╛ржЫрж┐ |
| ржирж┐ржпрж╝рзЗржЫрж┐ | рж▓ржЗржпрж╝рж╛ржЫрж┐ |
| ржкрзЗржпрж╝рзЗржЫрж┐ | ржкрж╛ржЗржпрж╝рж╛ржЫрж┐ |
| ржЦрзЗржпрж╝рзЗржЫрж┐ | ржЦрж╛ржЗржпрж╝рж╛ржЫрж┐ |
| рж╢рзБржирзЗржЫрж┐ | рж╢рзБржирж┐ржпрж╝рж╛ржЫрж┐ |
| ржмрж▓рзЗржЫрж┐ | ржмрж▓рж┐ржпрж╝рж╛ржЫрж┐ |
| ржжрзЗржЦрзЗржЫрж┐ | ржжрзЗржЦрж┐ржпрж╝рж╛ржЫрж┐ |
| рж╣ржпрж╝рзЗржЫрзЗ | рж╣ржЗржпрж╝рж╛ржЫрзЗ |
| ржПрж╕рзЗржЫрж┐ | ржЖрж╕рж┐ржпрж╝рж╛ржЫрж┐ |
| ржмрж╕рзЗржЫрж┐ | ржмрж╕рж┐ржпрж╝рж╛ржЫрж┐ |
| ржЙржарзЗржЫрж┐ | ржЙржарж┐ржпрж╝рж╛ржЫрж┐ |
| ржкржбрж╝рзЗржЫрж┐ | ржкржбрж╝рж┐ржпрж╝рж╛ржЫрж┐ |
| ржЫрж┐рж▓ | ржЫрж┐рж▓ |
| ржЫрж┐рж▓рж╛ржо | ржЫрж┐рж▓рж╛ржо |

ЁЯУМ **ржнржмрж┐рж╖рзНржпрзО ржХрж╛рж▓ (Future Tense):**

| ржЪрж▓рж┐ржд | рж╕рж╛ржзрзБ |
|------|------|
| ржХрж░ржм | ржХрж░рж┐ржм |
| ржХрж░ржмрзЗ | ржХрж░рж┐ржмрзЗ |
| ржХрж░ржмрзЗржи | ржХрж░рж┐ржмрзЗржи |
| ржпрж╛ржм | ржпрж╛ржЗржм |
| ржпрж╛ржмрзЗ | ржпрж╛ржЗржмрзЗ |
| ржЦрж╛ржм | ржЦрж╛ржЗржм |
| ржжрзЗржм | ржжрж┐ржм |
| ржирзЗржм | рж▓ржЗржм |
| рж╣ржмрзЗ | рж╣ржЗржмрзЗ |
| рж╣ржмрзЗржи | рж╣ржЗржмрзЗржи |
| ржкрж╛ржм | ржкрж╛ржЗржм |
| ржерж╛ржХржм | ржерж╛ржХрж┐ржм |
| ржЖрж╕ржм | ржЖрж╕рж┐ржм |
| ржмрж▓ржм | ржмрж▓рж┐ржм |
| рж╢рзБржиржм | рж╢рзБржирж┐ржм |

ЁЯУМ **ржЕржирзНржпрж╛ржирзНржп ржХрзНрж░рж┐ржпрж╝рж╛рж░рзВржк:**

| ржЪрж▓рж┐ржд | рж╕рж╛ржзрзБ |
|------|------|
| ржХрж░рждрзЗ | ржХрж░рж┐рждрзЗ |
| ржХрж░рждрзЗ ржкрж╛рж░рж┐ | ржХрж░рж┐рждрзЗ ржкрж╛рж░рж┐ |
| ржХрж░рждрзЗ рж╣ржмрзЗ | ржХрж░рж┐рждрзЗ рж╣ржЗржмрзЗ |
| ржХрж░рждрзЗ ржЪрж╛ржЗ | ржХрж░рж┐рждрзЗ ржЪрж╛ржЗ |
| ржХрж░рж▓рзЗ | ржХрж░рж┐рж▓рзЗ |
| рж╣рж▓рзЗ | рж╣ржЗрж▓рзЗ |
| ржЧрзЗрж▓рзЗ | ржЧрзЗрж▓рзЗ |
| ржХрж░рзЗ | ржХрж░рж┐ржпрж╝рж╛ |
| рж╣ржпрж╝рзЗ | рж╣ржЗржпрж╝рж╛ |
| ржЧрж┐ржпрж╝рзЗ | ржЧрж┐ржпрж╝рж╛ |
| ржирж┐ржпрж╝рзЗ | рж▓ржЗржпрж╝рж╛ |
| ржжрж┐ржпрж╝рзЗ | ржжрж┐ржпрж╝рж╛ |
| ржХрж░рзБржи | ржХрж░рзБржи |
| ржмрж▓рзБржи | ржмрж▓рзБржи |
| ржпрж╛ржи | ржпрж╛ржи |
| ржЖрж╕рзБржи | ржЖрж╕рзБржи |

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯФд рзи. рж╕рж░рзНржмржирж╛ржо рж░рзВржкрж╛ржирзНрждрж░
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

| ржЪрж▓рж┐ржд | рж╕рж╛ржзрзБ |
|------|------|
| рждрж╛рж░ | рждрж╛рж╣рж╛рж░ |
| рждрж╛ржХрзЗ | рждрж╛рж╣рж╛ржХрзЗ |
| рждрж╛рж╣рж╛ржжрзЗрж░ | рждрж╛рж╣рж╛ржжрзЗрж░ |
| рждрж╛ржжрзЗрж░ржХрзЗ | рждрж╛рж╣рж╛ржжрж┐ржЧржХрзЗ |
| ржпрж╛ | ржпрж╛рж╣рж╛ |
| ржпрзЗ | ржпрзЗ/ржпрж┐ржирж┐ |
| ржпрж╛ржХрзЗ | ржпрж╛рж╣рж╛ржХрзЗ |
| ржпрж╛рж░ | ржпрж╛рж╣рж╛рж░ |
| ржП | ржЗрж╣рж╛ |
| ржПржЯрж╛ | ржЗрж╣рж╛ |
| ржПржЯрж┐ | ржЗрж╣рж╛ |
| ржПржЗ | ржПржЗ |
| ржУ | ржЙрж╣рж╛ |
| ржУржЯрж╛ | ржЙрж╣рж╛ |
| ржУржЯрж┐ | ржЙрж╣рж╛ |
| рж╕рзЗ | рж╕рзЗ/рждрж┐ржирж┐ |
| ржХрзЗ | ржХрзЗ |
| ржХрзА | ржХрж┐ |
| ржХрж╛рж░ | ржХрж╛рж╣рж╛рж░ |
| ржХрж╛ржХрзЗ | ржХрж╛рж╣рж╛ржХрзЗ |
| ржПржЦрж╛ржирзЗ | ржПржЗржЦрж╛ржирзЗ/ржЗрж╣рж╛рждрзЗ |
| рж╕рзЗржЦрж╛ржирзЗ | рж╕рзЗржЗржЦрж╛ржирзЗ/рждржерж╛ржпрж╝ |
| ржпрзЗржЦрж╛ржирзЗ | ржпрзЗржЦрж╛ржирзЗ/ржпржерж╛ржпрж╝ |

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯФд рзй. ржЕржмрзНржпржпрж╝ ржУ ржпрзЛржЬржХ
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

| ржЪрж▓рж┐ржд | рж╕рж╛ржзрзБ |
|------|------|
| рждрж╛ржЗ | ржЕрждржПржм/рж╕рзБрждрж░рж╛ржВ |
| рждржмрзБржУ | рждржерж╛ржкрж┐ |
| ржХрж┐ржирзНрждрзБ | ржХрж┐ржирзНрждрзБ/ржкрж░ржирзНрждрзБ |
| ржЖрж░ | ржПржмржВ/ржУ |
| ржпржжрж┐ржУ | ржпржжрзНржпржкрж┐ |
| рждрж╛рж╣рж▓рзЗ | рждржмрзЗ/рждрж╛рж╣рж╛ рж╣ржЗрж▓рзЗ |
| ржирж╛рж╣рж▓рзЗ | ржирждрзБржмрж╛/рждрж╛рж╣рж╛ ржирж╛ рж╣ржЗрж▓рзЗ |
| ржЕржержмрж╛ | ржЕржержмрж╛/ржХрж┐ржВржмрж╛ |
| рждрж╛рж░ржкрж░ | рждрзОржкрж░/ржЕржиржирзНрждрж░ |
| ржПржЬржирзНржп | ржПржЗ ржЬржирзНржп/ржПржЗ рж╣рзЗрждрзБ |
| ржХрж╛рж░ржг | ржХрж╛рж░ржг/ржпрзЗрж╣рзЗрждрзБ |

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯФд рзк. ржмрж┐рж╢рзЗрж╖ржг ржУ ржХрзНрж░рж┐ржпрж╝рж╛ржмрж┐рж╢рзЗрж╖ржг
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

| ржЪрж▓рж┐ржд | рж╕рж╛ржзрзБ |
|------|------|
| ржПржоржи | ржПржЗрж░рзВржк/ржПржЗржоржд |
| рждрзЗржоржи | рждржжрзНрж░рзВржк/рж╕рзЗржЗрж░рзВржк |
| ржХрзЗржоржи | ржХрж┐рж░рзВржк |
| ржПржнрж╛ржмрзЗ | ржПржЗрж░рзВржкрзЗ/ржПржЗржнрж╛ржмрзЗ |
| рж╕рзЗржнрж╛ржмрзЗ | рж╕рзЗржЗрж░рзВржкрзЗ |
| ржПржЦржи | ржПржЦржи/ржПржХрзНрж╖ржгрзЗ |
| рждржЦржи | рждржЦржи/рждрзОржХрзНрж╖ржгрж╛рзО |
| ржЖржЬ | ржЖржЬ/ржЕржжрзНржп |
| ржХрж╛рж▓ | ржХрж▓рзНржп |`,

    'cholito': `ржЖржкржирж┐ ржПржХржЬржи ржмрж╛ржВрж▓рж╛ ржмрзНржпрж╛ржХрж░ржг ржмрж┐рж╢рзЗрж╖ржЬрзНржЮ ржПржмржВ ржнрж╛рж╖рж╛рждрждрзНрждрзНржмржмрж┐ржжред ржирж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯржХрзЗ **ржЪрж▓рж┐ржд рж░рзАрждрж┐**рждрзЗ рж░рзВржкрж╛ржирзНрждрж░рзЗрж░ ржЬржирзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ЁЯУЪ **ржЪрж▓рж┐ржд рж░рзАрждрж┐рж░ рж╕ржорзНржкрзВрж░рзНржг ржирж┐ржпрж╝ржорж╛ржмрж▓рзА:**

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯФд рзз. ржХрзНрж░рж┐ржпрж╝рж╛ржкржж рж░рзВржкрж╛ржирзНрждрж░ (рж╕ржмржЪрзЗржпрж╝рзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг)
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

ЁЯУМ **ржмрж░рзНрждржорж╛ржи ржХрж╛рж▓ (Present Tense):**

| рж╕рж╛ржзрзБ | ржЪрж▓рж┐ржд |
|------|------|
| ржХрж░рж┐рждрзЗржЫрж┐ | ржХрж░ржЫрж┐ |
| ржХрж░рж┐рждрзЗржЫ | ржХрж░ржЫ |
| ржХрж░рж┐рждрзЗржЫрзЗ | ржХрж░ржЫрзЗ |
| ржХрж░рж┐рждрзЗржЫрзЗржи | ржХрж░ржЫрзЗржи |
| ржЦрж╛ржЗрждрзЗржЫрж┐ | ржЦрж╛ржЪрзНржЫрж┐ |
| ржпрж╛ржЗрждрзЗржЫрж┐ | ржпрж╛ржЪрзНржЫрж┐ |
| ржжрзЗржЦрж┐рждрзЗржЫрж┐ | ржжрзЗржЦржЫрж┐ |
| ржмрж▓рж┐рждрзЗржЫрж┐ | ржмрж▓ржЫрж┐ |
| рж╢рзБржирж┐рждрзЗржЫрж┐ | рж╢рзБржиржЫрж┐ |
| ржкржбрж╝рж┐рждрзЗржЫрж┐ | ржкржбрж╝ржЫрж┐ |
| рж▓рж┐ржЦрж┐рждрзЗржЫрж┐ | рж▓рж┐ржЦржЫрж┐ |
| ржзрж░рж┐рждрзЗржЫрж┐ | ржзрж░ржЫрж┐ |
| ржЪрж▓рж┐рждрзЗржЫрж┐ | ржЪрж▓ржЫрж┐ |
| рж╣ржЗрждрзЗржЫрж┐ | рж╣ржЪрзНржЫрж┐ |
| ржЖрж╕рж┐рждрзЗржЫрж┐ | ржЖрж╕ржЫрж┐ |
| рж▓ржЗрждрзЗржЫрж┐ | ржирж┐ржЪрзНржЫрж┐ |
| ржжрж┐рждрзЗржЫрж┐ | ржжрж┐ржЪрзНржЫрж┐ |

ЁЯУМ **ржЕрждрзАржд ржХрж╛рж▓ (Past Tense):**

| рж╕рж╛ржзрзБ | ржЪрж▓рж┐ржд |
|------|------|
| ржХрж░рж┐ржпрж╝рж╛ржЫрж┐ | ржХрж░рзЗржЫрж┐ |
| ржХрж░рж┐ржпрж╝рж╛ржЫ | ржХрж░рзЗржЫ |
| ржХрж░рж┐ржпрж╝рж╛ржЫрзЗ | ржХрж░рзЗржЫрзЗ |
| ржХрж░рж┐ржпрж╝рж╛ржЫрж┐рж▓ | ржХрж░рзЗржЫрж┐рж▓ |
| ржХрж░рж┐ржпрж╝рж╛ржЫрж┐рж▓рж╛ржо | ржХрж░рзЗржЫрж┐рж▓рж╛ржо |
| ржХрж░рж┐ржпрж╝рж╛ржЫрж┐рж▓рзЗржи | ржХрж░рзЗржЫрж┐рж▓рзЗржи |
| ржЧрж┐ржпрж╝рж╛ржЫрж┐ | ржЧрж┐ржпрж╝рзЗржЫрж┐/ржЧрзЗржЫрж┐ |
| ржжрж┐ржпрж╝рж╛ржЫрж┐ | ржжрж┐ржпрж╝рзЗржЫрж┐ |
| рж▓ржЗржпрж╝рж╛ржЫрж┐ | ржирж┐ржпрж╝рзЗржЫрж┐ |
| ржкрж╛ржЗржпрж╝рж╛ржЫрж┐ | ржкрзЗржпрж╝рзЗржЫрж┐ |
| ржЦрж╛ржЗржпрж╝рж╛ржЫрж┐ | ржЦрзЗржпрж╝рзЗржЫрж┐ |
| рж╢рзБржирж┐ржпрж╝рж╛ржЫрж┐ | рж╢рзБржирзЗржЫрж┐ |
| ржмрж▓рж┐ржпрж╝рж╛ржЫрж┐ | ржмрж▓рзЗржЫрж┐ |
| ржжрзЗржЦрж┐ржпрж╝рж╛ржЫрж┐ | ржжрзЗржЦрзЗржЫрж┐ |
| рж╣ржЗржпрж╝рж╛ржЫрзЗ | рж╣ржпрж╝рзЗржЫрзЗ |
| ржЖрж╕рж┐ржпрж╝рж╛ржЫрж┐ | ржПрж╕рзЗржЫрж┐ |
| ржмрж╕рж┐ржпрж╝рж╛ржЫрж┐ | ржмрж╕рзЗржЫрж┐ |
| ржЙржарж┐ржпрж╝рж╛ржЫрж┐ | ржЙржарзЗржЫрж┐ |
| ржкржбрж╝рж┐ржпрж╝рж╛ржЫрж┐ | ржкржбрж╝рзЗржЫрж┐ |

ЁЯУМ **ржнржмрж┐рж╖рзНржпрзО ржХрж╛рж▓ (Future Tense):**

| рж╕рж╛ржзрзБ | ржЪрж▓рж┐ржд |
|------|------|
| ржХрж░рж┐ржм | ржХрж░ржм |
| ржХрж░рж┐ржмрзЗ | ржХрж░ржмрзЗ |
| ржХрж░рж┐ржмрзЗржи | ржХрж░ржмрзЗржи |
| ржпрж╛ржЗржм | ржпрж╛ржм |
| ржпрж╛ржЗржмрзЗ | ржпрж╛ржмрзЗ |
| ржЦрж╛ржЗржм | ржЦрж╛ржм |
| ржжрж┐ржм | ржжрзЗржм |
| рж▓ржЗржм | ржирзЗржм |
| рж╣ржЗржмрзЗ | рж╣ржмрзЗ |
| рж╣ржЗржмрзЗржи | рж╣ржмрзЗржи |
| ржкрж╛ржЗржм | ржкрж╛ржм |
| ржерж╛ржХрж┐ржм | ржерж╛ржХржм |
| ржЖрж╕рж┐ржм | ржЖрж╕ржм |
| ржмрж▓рж┐ржм | ржмрж▓ржм |
| рж╢рзБржирж┐ржм | рж╢рзБржиржм |

ЁЯУМ **ржЕржирзНржпрж╛ржирзНржп ржХрзНрж░рж┐ржпрж╝рж╛рж░рзВржк:**

| рж╕рж╛ржзрзБ | ржЪрж▓рж┐ржд |
|------|------|
| ржХрж░рж┐рждрзЗ | ржХрж░рждрзЗ |
| ржХрж░рж┐рждрзЗ ржкрж╛рж░рж┐ | ржХрж░рждрзЗ ржкрж╛рж░рж┐ |
| ржХрж░рж┐рждрзЗ рж╣ржЗржмрзЗ | ржХрж░рждрзЗ рж╣ржмрзЗ |
| ржХрж░рж┐рж▓рзЗ | ржХрж░рж▓рзЗ |
| рж╣ржЗрж▓рзЗ | рж╣рж▓рзЗ |
| ржХрж░рж┐ржпрж╝рж╛ | ржХрж░рзЗ |
| рж╣ржЗржпрж╝рж╛ | рж╣ржпрж╝рзЗ |
| ржЧрж┐ржпрж╝рж╛ | ржЧрж┐ржпрж╝рзЗ |
| рж▓ржЗржпрж╝рж╛ | ржирж┐ржпрж╝рзЗ |
| ржжрж┐ржпрж╝рж╛ | ржжрж┐ржпрж╝рзЗ |
| ржмрж▓рж┐ржпрж╝рж╛ | ржмрж▓рзЗ |
| рж╢рзБржирж┐ржпрж╝рж╛ | рж╢рзБржирзЗ |

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯФд рзи. рж╕рж░рзНржмржирж╛ржо рж░рзВржкрж╛ржирзНрждрж░
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

| рж╕рж╛ржзрзБ | ржЪрж▓рж┐ржд |
|------|------|
| рждрж╛рж╣рж╛рж░ | рждрж╛рж░ |
| рждрж╛рж╣рж╛ржХрзЗ | рждрж╛ржХрзЗ |
| рждрж╛рж╣рж╛ржжрзЗрж░ | рждрж╛рж╣рж╛ржжрзЗрж░ |
| рждрж╛рж╣рж╛ржжрж┐ржЧржХрзЗ | рждрж╛ржжрзЗрж░ржХрзЗ |
| ржпрж╛рж╣рж╛ | ржпрж╛ |
| ржпрж╛рж╣рж╛ржХрзЗ | ржпрж╛ржХрзЗ |
| ржпрж╛рж╣рж╛рж░ | ржпрж╛рж░ |
| ржЗрж╣рж╛ | ржПржЯрж╛/ржПржЯрж┐ |
| ржЙрж╣рж╛ | ржУржЯрж╛/ржУржЯрж┐/рж╕рзЗржЯрж╛ |
| ржХрж╛рж╣рж╛рж░ | ржХрж╛рж░ |
| ржХрж╛рж╣рж╛ржХрзЗ | ржХрж╛ржХрзЗ |
| ржЗрж╣рж╛рждрзЗ | ржПрждрзЗ |
| рждрж╛рж╣рж╛рждрзЗ | рждрж╛рждрзЗ |
| рждржерж╛ржпрж╝ | рж╕рзЗржЦрж╛ржирзЗ |
| ржпржерж╛ржпрж╝ | ржпрзЗржЦрж╛ржирзЗ |

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯФд рзй. ржЕржмрзНржпржпрж╝ ржУ ржпрзЛржЬржХ
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

| рж╕рж╛ржзрзБ | ржЪрж▓рж┐ржд |
|------|------|
| ржЕрждржПржм | рждрж╛ржЗ |
| рж╕рзБрждрж░рж╛ржВ | рждрж╛ржЗ |
| рждржерж╛ржкрж┐ | рждржмрзБржУ |
| ржкрж░ржирзНрждрзБ | ржХрж┐ржирзНрждрзБ |
| ржпржжрзНржпржкрж┐ | ржпржжрж┐ржУ |
| рждрж╛рж╣рж╛ рж╣ржЗрж▓рзЗ | рждрж╛рж╣рж▓рзЗ |
| ржирждрзБржмрж╛ | ржирж╛рж╣рж▓рзЗ |
| рждрзОржкрж░ | рждрж╛рж░ржкрж░ |
| ржПржЗ рж╣рзЗрждрзБ | ржПржЬржирзНржп |

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯФд рзк. ржмрж┐рж╢рзЗрж╖ржг ржУ ржХрзНрж░рж┐ржпрж╝рж╛ржмрж┐рж╢рзЗрж╖ржг
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

| рж╕рж╛ржзрзБ | ржЪрж▓рж┐ржд |
|------|------|
| ржПржЗрж░рзВржк | ржПржоржи |
| рждржжрзНрж░рзВржк | рждрзЗржоржи |
| ржХрж┐рж░рзВржк | ржХрзЗржоржи |
| ржПржЗрж░рзВржкрзЗ | ржПржнрж╛ржмрзЗ |
| рж╕рзЗржЗрж░рзВржкрзЗ | рж╕рзЗржнрж╛ржмрзЗ |
| ржПржХрзНрж╖ржгрзЗ | ржПржЦржи |
| ржЕржжрзНржп | ржЖржЬ |
| ржХрж▓рзНржп | ржХрж╛рж▓ |`
  };

  const targetStyle = style === 'sadhu' ? 'рж╕рж╛ржзрзБ' : 'ржЪрж▓рж┐ржд';
  const sourceStyle = style === 'sadhu' ? 'ржЪрж▓рж┐ржд' : 'рж╕рж╛ржзрзБ';

  return `${styleInstructions[style]}

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯУЭ ржмрж┐рж╢рзНрж▓рзЗрж╖ржгрзЗрж░ ржЬржирзНржп ржЯрзЗржХрзНрж╕ржЯ:
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
"${text}"

тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР
ЁЯУЛ ржЖржкржирж╛рж░ ржХрж╛ржЬ:
тХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХРтХР

1. **ржкрзНрж░рждрж┐ржЯрж┐ рж╢ржмрзНржж ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи** - ржмрж┐рж╢рзЗрж╖ ржХрж░рзЗ ржХрзНрж░рж┐ржпрж╝рж╛ржкржж, рж╕рж░рзНржмржирж╛ржо, ржЕржмрзНржпржпрж╝
2. **${sourceStyle} рж░рзАрждрж┐рж░ рж╢ржмрзНржж ржЪрж┐рж╣рзНржирж┐ржд ржХрж░рзБржи** - ржпрзЗржЧрзБрж▓рзЛ ${targetStyle} рж░рзАрждрж┐рждрзЗ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ рж╣ржмрзЗ
3. **рж╕ржарж┐ржХ ${targetStyle} рж░рзВржк ржжрж┐ржи** - ржЙржкрж░рзЗрж░ ржирж┐ржпрж╝ржорж╛ржмрж▓рзА ржЕржирзБрж╕рж░ржг ржХрж░рзЗ
4. **рж╢ржмрзНржжрзЗрж░ ржзрж░ржи ржЙрж▓рзНрж▓рзЗржЦ ржХрж░рзБржи** - ржХрзНрж░рж┐ржпрж╝рж╛ржкржж/рж╕рж░рзНржмржирж╛ржо/ржЕржмрзНржпржпрж╝/ржмрж┐рж╢рзЗрж╖ржг

тЪая╕П **рж╕рждрж░рзНржХрждрж╛:**
- рж╢ржмрзНржжржЯрж┐ ржЯрзЗржХрзНрж╕ржЯрзЗ рж╣рзБржмрж╣рзБ ржпрзЗржнрж╛ржмрзЗ ржЖржЫрзЗ рж╕рзЗржнрж╛ржмрзЗржЗ "current" ржлрж┐рж▓рзНржбрзЗ ржжрж┐ржи
- ржкрзНрж░рждрж┐ржЯрж┐ ${sourceStyle} рж░рзАрждрж┐рж░ рж╢ржмрзНржж ржЖрж▓рж╛ржжрж╛ржнрж╛ржмрзЗ ржжрж┐ржи
- ржПржХржЗ рж╢ржмрзНржж ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржерж╛ржХрж▓рзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржЖрж▓рж╛ржжрж╛ржнрж╛ржмрзЗ ржжрж┐ржи
- ржпржжрж┐ ржХрзЛржи ${sourceStyle} рж░рзАрждрж┐рж░ рж╢ржмрзНржж ржирж╛ ржерж╛ржХрзЗ рждрж╛рж╣рж▓рзЗ ржЦрж╛рж▓рж┐ array ржжрж┐ржи
- рж╢рзБржзрзБржорж╛рждрзНрж░ ржнрж╛рж╖рж╛рж░рзАрждрж┐ рж╕ржВржХрзНрж░рж╛ржирзНржд ржкрж░рж┐ржмрж░рзНрждржи рж╕рж╛ржЬрзЗрж╕рзНржЯ ржХрж░рзБржи, ржмрж╛ржирж╛ржи ржмрж╛ ржЕржирзНржп рж╕ржорж╕рзНржпрж╛ ржиржпрж╝

ЁЯУд **Response Format (рж╢рзБржзрзБржорж╛рждрзНрж░ valid JSON):**
{
  "styleConversions": [
    {
      "current": "ржмрж░рзНрждржорж╛ржи ${sourceStyle} рж░рзАрждрж┐рж░ рж╢ржмрзНржж (рж╣рзБржмрж╣рзБ ржЯрзЗржХрзНрж╕ржЯ ржерзЗржХрзЗ)",
      "suggestion": "${targetStyle} рж░рзАрждрж┐рждрзЗ рж░рзВржкрж╛ржирзНрждрж░рж┐ржд рж╢ржмрзНржж",
      "type": "ржХрзНрж░рж┐ржпрж╝рж╛ржкржж/рж╕рж░рзНржмржирж╛ржо/ржЕржмрзНржпржпрж╝/ржмрж┐рж╢рзЗрж╖ржг"
    }
  ]
}`;
};

/* -------------------------------------------------------------------------- */
/*                           MAIN COMPONENT                                   */
/* -------------------------------------------------------------------------- */

function App() {
  // Settings State
  const [apiKey, setApiKey] = useState(localStorage.getItem('gemini_api_key') || '');
  const [selectedModel, setSelectedModel] = useState(localStorage.getItem('gemini_model') || 'gemini-2.5-flash');
  
  // UI State
  const [isLoading, setIsLoading] = useState(false);
  const [loadingText, setLoadingText] = useState('');
  const [message, setMessage] = useState<{ text: string; type: 'success' | 'error' } | null>(null);
  const [activeModal, setActiveModal] = useState<'none' | 'settings' | 'instructions' | 'tone' | 'style'>('none');
  
  // Selection State
  const [selectedTone, setSelectedTone] = useState('');
  const [selectedStyle, setSelectedStyle] = useState('none');

  // Data State
  const [corrections, setCorrections] = useState<Correction[]>([]);
  const [toneSuggestions, setToneSuggestions] = useState<ToneSuggestion[]>([]);
  const [styleSuggestions, setStyleSuggestions] = useState<StyleSuggestion[]>([]);
  const [languageStyleMixing, setLanguageStyleMixing] = useState<StyleMixing | null>(null);
  const [punctuationIssues, setPunctuationIssues] = useState<PunctuationIssue[]>([]);
  const [euphonyImprovements, setEuphonyImprovements] = useState<EuphonyImprovement[]>([]);
  const [contentAnalysis, setContentAnalysis] = useState<ContentAnalysis | null>(null);
  
  const [stats, setStats] = useState({ totalWords: 0, errorCount: 0, accuracy: 100 });

  useEffect(() => {
    // Initialize Office
  }, []);

  /* --- HELPERS --- */
  const showMessage = (text: string, type: 'success' | 'error') => {
    setMessage({ text, type });
    setTimeout(() => setMessage(null), 3000);
  };

  const saveSettings = () => {
    localStorage.setItem('gemini_api_key', apiKey);
    localStorage.setItem('gemini_model', selectedModel);
    showMessage('рж╕рзЗржЯрж┐ржВрж╕ рж╕ржВрж░ржХрзНрж╖рж┐ржд рж╣ржпрж╝рзЗржЫрзЗ! тЬУ', 'success');
    setActiveModal('none');
  };

  /* --- WORD API INTERACTION --- */
  const getTextFromWord = async (): Promise<string> => {
    return new Promise((resolve) => {
      Word.run(async (context) => {
        const body = context.document.body;
        body.load('text');
        await context.sync();
        resolve(body.text);
      }).catch((error) => {
        console.error('Error reading Word:', error);
        resolve('');
      });
    });
  };

  const highlightInWord = async (text: string, color: string) => {
    await Word.run(async (context) => {
      // matchWholeWord: false ensures we find words even with attached punctuation
      const results = context.document.body.search(text, { matchCase: false, matchWholeWord: false });
      results.load('font');
      await context.sync();
      
      for (let i = 0; i < results.items.length; i++) {
        results.items[i].font.highlightColor = color;
      }
      await context.sync();
    }).catch(console.error);
  };

  const replaceInWord = async (oldText: string, newText: string) => {
    await Word.run(async (context) => {
      // Using search for replacement
      const results = context.document.body.search(oldText, { matchCase: true, matchWholeWord: false });
      results.load();
      await context.sync();

      results.items.forEach((item) => {
        item.insertText(newText, Word.InsertLocation.replace);
        item.font.highlightColor = "None"; // Fixed TS Error (using string "None" instead of null)
      });
      await context.sync();
    }).catch(console.error);

    // UI Update - Remove fixed item from lists
    setCorrections(prev => prev.filter(c => c.wrong !== oldText));
    setToneSuggestions(prev => prev.filter(t => t.current !== oldText));
    setStyleSuggestions(prev => prev.filter(s => s.current !== oldText));
    setEuphonyImprovements(prev => prev.filter(e => e.current !== oldText));
    
    if (languageStyleMixing?.corrections) {
      const filtered = languageStyleMixing.corrections.filter(c => c.current !== oldText);
      setLanguageStyleMixing(filtered.length ? { ...languageStyleMixing, corrections: filtered } : null);
    }

    showMessage(`"${oldText}" тЖТ "${newText}" тЬУ`, 'success');
  };

  const clearHighlights = async () => {
    await Word.run(async (context) => {
      context.document.body.font.highlightColor = "None"; // Fixed TS Error (using string "None" instead of null)
      await context.sync();
    }).catch(console.error);
  };

  /* --- API LOGIC --- */
  const checkSpelling = async () => {
    if (!apiKey) {
      showMessage('ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржкрзНрж░ржержорзЗ API Key ржжрж┐ржи', 'error');
      setActiveModal('settings');
      return;
    }

    const text = await getTextFromWord();
    if (!text || text.trim().length === 0) {
      showMessage('ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржЯрзЗржХрзНрж╕ржЯ рж▓рж┐ржЦрзБржи', 'error');
      return;
    }

    setIsLoading(true);
    setLoadingText('ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ...');
    
    // Clear previous results
    setCorrections([]);
    setToneSuggestions([]);
    setStyleSuggestions([]);
    setLanguageStyleMixing(null);
    setPunctuationIssues([]);
    setEuphonyImprovements([]);
    setContentAnalysis(null);

    await clearHighlights();

    try {
      // 1. Main Analysis
      setLoadingText('ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ...');
      await performMainCheck(text);

      // 2. Tone Analysis
      if (selectedTone) {
        setLoadingText('ржЯрзЛржи ржмрж┐рж╢рзНрж▓рзЗрж╖ржг...');
        await performToneCheck(text);
      }

      // 3. Style Analysis
      if (selectedStyle !== 'none') {
        setLoadingText('ржнрж╛рж╖рж╛рж░рзАрждрж┐ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг...');
        await performStyleCheck(text);
      }

      // 4. Content Analysis
      setLoadingText('ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ...');
      await analyzeContent(text);

    } catch (error) {
      console.error(error);
      showMessage('рждрзНрж░рзБржЯрж┐ рж╣ржпрж╝рзЗржЫрзЗред API Key ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржиред', 'error');
    } finally {
      setIsLoading(false);
      setLoadingText('');
    }
  };

  const performMainCheck = async (text: string) => {
    const response = await fetch(
      `https://generativelanguage.googleapis.com/v1beta/models/${selectedModel}:generateContent?key=${apiKey}`,
      {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          contents: [{
            parts: [{
              text: `ржЖржкржирж┐ ржПржХржЬржи ржмрж╛ржВрж▓рж╛ ржнрж╛рж╖рж╛ ржмрж┐рж╢рзЗрж╖ржЬрзНржЮред ржирж┐ржЪрзЗрж░ ржмрж╛ржВрж▓рж╛ ржЯрзЗржХрзНрж╕ржЯ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред

ржЯрзЗржХрзНрж╕ржЯ: "${text}"

тЪая╕П ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржирж┐рж░рзНржжрзЗрж╢ржирж╛:
- рж╢рзБржзрзБржорж╛рждрзНрж░ ржирж┐рж╢рзНржЪрж┐ржд ржнрзБрж▓ ржЪрж┐рж╣рзНржирж┐ржд ржХрж░рзБржи
- ржмрж╛ржВрж▓рж╛ ржПржХрж╛ржбрзЗржорж┐ рж░рзАрждрж┐ ржорзЗржирзЗ ржЪрж▓рзБржи

ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржи:
1. **ржмрж╛ржирж╛ржи ржнрзБрж▓** - ржпрзБржХрзНрждрж╛ржХрзНрж╖рж░, ржг-ржи, рж╢-рж╖-рж╕, ржЗ-ржИ, ржЙ-ржК ржЗрждрзНржпрж╛ржжрж┐
2. **рж╕рж╛ржзрзБ-ржЪрж▓рж┐ржд ржорж┐рж╢рзНрж░ржг рж╕ржирж╛ржХрзНрждржХрж░ржг** - ржПржХржЗ рж▓рзЗржЦрж╛ржпрж╝ ржжрзБржЗ рж░рзАрждрж┐рж░ ржорж┐рж╢рзНрж░ржг ржЖржЫрзЗ ржХрж┐ржирж╛
3. **ржмрж┐рж░рж╛ржо ржЪрж┐рж╣рзНржи рж╕ржорж╕рзНржпрж╛** - ржжрж╛ржБржбрж╝рж┐, ржХржорж╛, ржкрзНрж░рж╢рзНржиржмрзЛржзржХ ржЗрждрзНржпрж╛ржжрж┐
4. **рж╢рзНрж░рзБрждрж┐ржоржзрзБрж░рждрж╛ ржЙржирзНржирждрж┐** - ржкрзБржирж░рж╛ржмрзГрждрзНрждрж┐, ржЬржЯрж┐рж▓ рж╢ржмрзНржжрзЗрж░ рж╕рж╣ржЬ ржмрж┐ржХрж▓рзНржк

Response format (рж╢рзБржзрзБржорж╛рждрзНрж░ valid JSON):
{
  "spellingErrors": [
    {"wrong": "ржнрзБрж▓ рж╢ржмрзНржж", "suggestions": ["рж╕ржарж┐ржХ рзз", "рж╕ржарж┐ржХ рзи"], "position": 0}
  ],
  "languageStyleMixing": {
    "detected": true/false,
    "recommendedStyle": "рж╕рж╛ржзрзБ рж░рзАрждрж┐/ржЪрж▓рж┐ржд рж░рзАрждрж┐",
    "reason": "ржХрж╛рж░ржг",
    "corrections": [{"current": "рж╢ржмрзНржж", "suggestion": "рж╕ржВрж╢рзЛржзржи", "type": "рж╕рж╛ржзрзБтЖТржЪрж▓рж┐ржд"}]
  },
  "punctuationIssues": [
    {"issue": "рж╕ржорж╕рзНржпрж╛", "currentSentence": "ржмрж╛ржХрзНржп", "correctedSentence": "рж╕ржВрж╢рзЛржзрж┐ржд", "explanation": "ржмрзНржпрж╛ржЦрзНржпрж╛"}
  ],
  "euphonyImprovements": [
    {"current": "рж╢ржмрзНржж", "suggestions": ["ржмрж┐ржХрж▓рзНржк"], "reason": "ржХрж╛рж░ржг"}
  ]
}`
            }]
          }]
        })
      }
    );

    const data = await response.json();
    const resultText = data.candidates[0].content.parts[0].text;
    const jsonMatch = resultText.match(/\{[\s\S]*\}/);

    if (jsonMatch) {
      const result = JSON.parse(jsonMatch[0]);
      setCorrections(result.spellingErrors || []);
      setLanguageStyleMixing(result.languageStyleMixing || null);
      setPunctuationIssues(result.punctuationIssues || []);
      setEuphonyImprovements(result.euphonyImprovements || []);

      // Update stats
      const words = text.trim().split(/\s+/).length;
      const errors = (result.spellingErrors?.length || 0);
      setStats({
        totalWords: words,
        errorCount: errors,
        accuracy: Math.round(((words - errors) / words) * 100) || 100
      });

      // Highlight Errors (Red)
      for (const err of (result.spellingErrors || [])) {
        await highlightInWord(err.wrong, '#fee2e2');
      }
    }
  };

  const performToneCheck = async (text: string) => {
    const prompt = buildTonePrompt(text, selectedTone);
    const response = await fetch(
      `https://generativelanguage.googleapis.com/v1beta/models/${selectedModel}:generateContent?key=${apiKey}`,
      {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ contents: [{ parts: [{ text: `${prompt}\n\nржпржжрж┐ ржХрзЛржи ржкрж░рж┐ржмрж░рзНрждржи ржкрзНрж░ржпрж╝рзЛржЬржи ржирж╛ рж╣ржпрж╝ рждрж╛рж╣рж▓рзЗ ржЦрж╛рж▓рж┐ array ржжрж┐ржиред` }] }] })
      }
    );
    const data = await response.json();
    const resultText = data.candidates[0].content.parts[0].text;
    const jsonMatch = resultText.match(/\{[\s\S]*\}/);
    if (jsonMatch) {
      const result = JSON.parse(jsonMatch[0]);
      setToneSuggestions(result.toneConversions || []);
      // Highlight Tone issues (Yellow)
      for (const t of (result.toneConversions || [])) {
        await highlightInWord(t.current, '#fef3c7');
      }
    }
  };

  const performStyleCheck = async (text: string) => {
    const prompt = buildStylePrompt(text, selectedStyle);
    const response = await fetch(
      `https://generativelanguage.googleapis.com/v1beta/models/${selectedModel}:generateContent?key=${apiKey}`,
      {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ contents: [{ parts: [{ text: `${prompt}\n\nржпржжрж┐ ржХрзЛржи ржкрж░рж┐ржмрж░рзНрждржи ржкрзНрж░ржпрж╝рзЛржЬржи ржирж╛ рж╣ржпрж╝ рждрж╛рж╣рж▓рзЗ ржЦрж╛рж▓рж┐ array ржжрж┐ржиред` }] }] })
      }
    );
    const data = await response.json();
    const resultText = data.candidates[0].content.parts[0].text;
    const jsonMatch = resultText.match(/\{[\s\S]*\}/);
    if (jsonMatch) {
      const result = JSON.parse(jsonMatch[0]);
      setStyleSuggestions(result.styleConversions || []);
      // Highlight Style issues (Cyan)
      for (const s of (result.styleConversions || [])) {
        await highlightInWord(s.current, '#ccfbf1');
      }
    }
  };

  const analyzeContent = async (text: string) => {
    const response = await fetch(
      `https://generativelanguage.googleapis.com/v1beta/models/${selectedModel}:generateContent?key=${apiKey}`,
      {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          contents: [{
            parts: [{
              text: `ржмрж╛ржВрж▓рж╛ рж▓рзЗржЦрж╛ржЯрж┐ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржи:

ржЯрзЗржХрзНрж╕ржЯ: "${text}"

Response format (рж╢рзБржзрзБржорж╛рждрзНрж░ valid JSON):
{
  "contentType": "рж▓рзЗржЦрж╛рж░ ржзрж░ржи",
  "description": "рж╕ржВржХрзНрж╖рж┐ржкрзНржд ржмрж░рзНржгржирж╛",
  "missingElements": ["ржЕржирзБржкрж╕рзНржерж┐ржд ржЙржкрж╛ржжрж╛ржи"],
  "suggestions": ["ржЙржирзНржирждрж┐рж░ ржкрж░рж╛ржорж░рзНрж╢"]
}`
            }]
          }]
        })
      }
    );
    const data = await response.json();
    const resultText = data.candidates[0].content.parts[0].text;
    const jsonMatch = resultText.match(/\{[\s\S]*\}/);
    if (jsonMatch) {
      setContentAnalysis(JSON.parse(jsonMatch[0]));
    }
  };

  /* --- RENDER HELPERS --- */
  const getToneName = (t: string) => {
    const map: Record<string, string> = {
      'formal': 'ЁЯУЛ ржЖржирзБрж╖рзНржарж╛ржирж┐ржХ', 'informal': 'ЁЯТм ржЕржирж╛ржирзБрж╖рзНржарж╛ржирж┐ржХ', 'professional': 'ЁЯТ╝ ржкрзЗрж╢рж╛ржжрж╛рж░',
      'friendly': 'ЁЯШК ржмржирзНржзрзБрждрзНржмржкрзВрж░рзНржг', 'respectful': 'ЁЯЩП рж╕ржорзНржорж╛ржиржЬржиржХ', 'persuasive': 'ЁЯТк ржкрзНрж░ржнрж╛ржмрж╢рж╛рж▓рзА',
      'neutral': 'тЪЦя╕П ржирж┐рж░ржкрзЗржХрзНрж╖', 'academic': 'ЁЯУЪ рж╢рж┐ржХрзНрж╖рж╛ржорзВрж▓ржХ'
    };
    return map[t] || t;
  };

  /* --- UI RENDER --- */
  return (
    <div className="app-container">
      {/* Header & Toolbar */}
      <div className="header-section">
        <div className="header-top">
          <button className="icon-btn-small" onClick={() => setActiveModal('instructions')} title="рж╕рж╛рж╣рж╛ржпрзНржп">тЭУ</button>
          <div className="app-title">
            <h1>ЁЯМЯ ржнрж╛рж╖рж╛ ржорж┐рждрзНрж░</h1>
            <p>ржмрж╛ржВрж▓рж╛ ржмрж╛ржирж╛ржи ржУ ржмрзНржпрж╛ржХрж░ржг ржкрж░рзАржХрзНрж╖ржХ</p>
          </div>
          <button className="icon-btn-small" onClick={() => setActiveModal('settings')} title="рж╕рзЗржЯрж┐ржВрж╕">тЪЩя╕П</button>
        </div>

        <div className="toolbar">
          <button className={`icon-btn ${selectedTone ? 'active' : ''}`} onClick={() => setActiveModal('tone')} title="ржЯрзЛржи/ржнрж╛ржм ржирж┐рж░рзНржмрж╛ржЪржи">
            <span className="icon">ЁЯТм</span>
            <span className="label">ржЯрзЛржи</span>
            {selectedTone && <span className="badge">тЬУ</span>}
          </button>
          <button className={`icon-btn ${selectedStyle !== 'none' ? 'active' : ''}`} onClick={() => setActiveModal('style')} title="ржнрж╛рж╖рж╛рж░рзАрждрж┐ ржирж┐рж░рзНржмрж╛ржЪржи">
             <span className="icon">ЁЯУЭ</span>
            <span className="label">ржнрж╛рж╖рж╛рж░рзАрждрж┐</span>
            {selectedStyle !== 'none' && <span className="badge">тЬУ</span>}
          </button>
          <div style={{flex: 1}}></div>
          <button 
            onClick={checkSpelling} 
            disabled={isLoading}
            className="btn-check"
          >
            {isLoading ? '...' : 'ЁЯФН ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи'}
          </button>
        </div>
      </div>

      {/* Selection Display */}
      {(selectedTone || selectedStyle !== 'none') && (
        <div className="selection-display">
          {selectedTone && (
             <span className="selection-tag tone-tag">
               {getToneName(selectedTone)}
               <button onClick={() => setSelectedTone('')} className="clear-btn">тЬХ</button>
             </span>
          )}
          {selectedStyle !== 'none' && (
             <span className="selection-tag style-tag">
               {selectedStyle === 'sadhu' ? 'ЁЯУЬ рж╕рж╛ржзрзБ рж░рзАрждрж┐' : 'ЁЯТм ржЪрж▓рж┐ржд рж░рзАрждрж┐'}
               <button onClick={() => setSelectedStyle('none')} className="clear-btn">тЬХ</button>
             </span>
          )}
        </div>
      )}

      {/* Main Content */}
      <div className="content-area">
        
        {isLoading && (
          <div className="loading-box">
            <div className="loader"></div>
            <p>{loadingText}</p>
          </div>
        )}

        {message && (
          <div className={`message-box ${message.type}`}>
            {message.text}
          </div>
        )}

        {/* Empty State */}
        {!isLoading && stats.totalWords === 0 && !message && (
          <div className="empty-state">
            <div style={{fontSize: '40px', marginBottom: '12px'}}>тЬи</div>
            <p style={{fontSize: '13px', fontWeight: 500}}>рж╕рж╛ржЬрзЗрж╢ржи ржПржЦрж╛ржирзЗ ржжрзЗржЦрж╛ ржпрж╛ржмрзЗ</p>
            <p style={{fontSize: '11px', marginTop: '6px'}}>ржЯрзЗржХрзНрж╕ржЯ рж▓рж┐ржЦрзЗ "ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи" ржХрзНрж▓рж┐ржХ ржХрж░рзБржи</p>
          </div>
        )}

        {/* Stats */}
        {stats.totalWords > 0 && (
          <div className="stats-grid">
            <div className="stat-card">
              <div className="val" style={{color: '#667eea'}}>{stats.totalWords}</div>
              <div className="lbl">ржорзЛржЯ рж╢ржмрзНржж</div>
            </div>
            <div className="stat-card">
              <div className="val" style={{color: '#dc2626'}}>{stats.errorCount}</div>
              <div className="lbl">ржнрзБрж▓</div>
            </div>
            <div className="stat-card">
              <div className="val" style={{color: '#16a34a'}}>{stats.accuracy}%</div>
              <div className="lbl">рж╢рзБржжрзНржзрждрж╛</div>
            </div>
          </div>
        )}

        {/* Content Analysis */}
        {contentAnalysis && (
          <>
            <div className="analysis-card content-analysis">
              <h3>ЁЯУЛ {contentAnalysis.contentType}</h3>
              {contentAnalysis.description && <p>{contentAnalysis.description}</p>}
            </div>
            {contentAnalysis.missingElements && contentAnalysis.missingElements.length > 0 && (
              <div className="analysis-card missing-analysis">
                <h3 style={{color:'#78350f'}}>тЪая╕П ржпрж╛ ржпрзЛржЧ ржХрж░рзБржи</h3>
                <ul>{contentAnalysis.missingElements.map((e, i) => <li key={i}>{e}</li>)}</ul>
              </div>
            )}
             {contentAnalysis.suggestions && contentAnalysis.suggestions.length > 0 && (
              <div className="analysis-card suggestion-analysis">
                <h3 style={{color:'#115e59'}}>тЬи ржкрж░рж╛ржорж░рзНрж╢</h3>
                <ul>{contentAnalysis.suggestions.map((e, i) => <li key={i}>{e}</li>)}</ul>
              </div>
            )}
          </>
        )}

        {/* Spelling Errors */}
        {corrections.length > 0 && (
          <>
            <div className="section-header">
              <h3>ЁЯУЭ ржмрж╛ржирж╛ржи ржнрзБрж▓</h3>
              <span className="section-badge" style={{background: '#fee2e2', color: '#dc2626'}}>{corrections.length}ржЯрж┐</span>
            </div>
            {corrections.map((c, i) => (
              <div key={i} className="suggestion-card error-card" onMouseEnter={() => highlightInWord(c.wrong, '#fee2e2')}>
                <div className="wrong-word">тЭМ {c.wrong}</div>
                {c.suggestions.map((s, j) => (
                  <button key={j} onClick={() => replaceInWord(c.wrong, s)} className="suggestion-btn success-btn">
                    тЬУ {s}
                  </button>
                ))}
              </div>
            ))}
          </>
        )}

        {/* Tone Suggestions */}
        {toneSuggestions.length > 0 && (
          <>
            <div className="section-header">
              <h3>ЁЯТм ржЯрзЛржи рж░рзВржкрж╛ржирзНрждрж░</h3>
               <span className="section-badge" style={{background: '#fef3c7', color: '#92400e'}}>{getToneName(selectedTone)}</span>
            </div>
            {toneSuggestions.map((t, i) => (
              <div key={i} className="suggestion-card warning-card" onMouseEnter={() => highlightInWord(t.current, '#fef3c7')}>
                <div className="wrong-word" style={{color: '#b45309'}}>ЁЯТб {t.current}</div>
                {t.reason && <div className="reason">{t.reason}</div>}
                <button onClick={() => replaceInWord(t.current, t.suggestion)} className="suggestion-btn warning-btn">
                  тЬи {t.suggestion}
                </button>
              </div>
            ))}
          </>
        )}

        {/* Style Suggestions */}
        {styleSuggestions.length > 0 && (
          <>
            <div className="section-header">
              <h3>ЁЯУЭ ржнрж╛рж╖рж╛рж░рзАрждрж┐</h3>
               <span className="section-badge" style={{background: selectedStyle === 'sadhu' ? '#fef3c7' : '#ccfbf1', color: selectedStyle === 'sadhu' ? '#92400e' : '#0f766e'}}>
                 {selectedStyle === 'sadhu' ? 'ЁЯУЬ рж╕рж╛ржзрзБ рж░рзАрждрж┐' : 'ЁЯТм ржЪрж▓рж┐ржд рж░рзАрждрж┐'}
               </span>
            </div>
            {styleSuggestions.map((s, i) => (
              <div key={i} className="suggestion-card info-card" style={{borderColor: selectedStyle === 'sadhu' ? '#fbbf24' : '#5eead4'}} onMouseEnter={() => highlightInWord(s.current, '#ccfbf1')}>
                <div style={{display:'flex', gap:'6px', alignItems:'center', marginBottom:'4px'}}>
                    <span style={{fontSize:'13px', fontWeight:600, color: selectedStyle === 'sadhu' ? '#92400e' : '#0f766e'}}>ЁЯФД {s.current}</span>
                    {s.type && <span style={{fontSize:'9px', background:'white', padding:'2px 6px', borderRadius:'10px'}}>{s.type}</span>}
                </div>
                <button onClick={() => replaceInWord(s.current, s.suggestion)} className="suggestion-btn" style={{
                    background: selectedStyle === 'sadhu' ? 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)' : 'linear-gradient(135deg, #ccfbf1 0%, #99f6e4 100%)',
                    borderColor: selectedStyle === 'sadhu' ? '#fbbf24' : '#5eead4',
                    color: selectedStyle === 'sadhu' ? '#92400e' : '#0f766e'
                }}>
                  тЮЬ {s.suggestion}
                </button>
              </div>
            ))}
          </>
        )}

        {/* Auto Style Mixing Detection */}
        {languageStyleMixing?.detected && selectedStyle === 'none' && (
          <>
            <div className="section-header">
              <h3>ЁЯФД ржорж┐рж╢рзНрж░ржг рж╕ржирж╛ржХрзНржд</h3>
              <span className="section-badge" style={{background: '#e9d5ff', color: '#6b21a8'}}>рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝</span>
            </div>
            <div className="suggestion-card purple-card" style={{background: 'rgba(237, 233, 254, 0.5)'}}>
              <div style={{fontSize: '13px', fontWeight: 600, color: '#6b21a8'}}>
                ржкрзНрж░рж╕рзНрждрж╛ржмрж┐ржд: {languageStyleMixing.recommendedStyle}
              </div>
              <div style={{fontSize: '10px', color: '#6b7280', marginTop: '4px'}}>{languageStyleMixing.reason}</div>
            </div>
            {languageStyleMixing.corrections?.map((c, i) => (
              <div key={i} className="suggestion-card purple-card-light" onMouseEnter={() => highlightInWord(c.current, '#e9d5ff')}>
                 <div style={{display:'flex', gap:'6px', alignItems:'center', marginBottom:'4px'}}>
                    <span style={{fontSize:'13px', fontWeight:600, color: '#7c3aed'}}>ЁЯФД {c.current}</span>
                    <span style={{fontSize:'9px', background:'#e9d5ff', color:'#6b21a8', padding:'2px 6px', borderRadius:'10px'}}>{c.type}</span>
                </div>
                <button onClick={() => replaceInWord(c.current, c.suggestion)} className="suggestion-btn purple-btn">
                  тЮЬ {c.suggestion}
                </button>
              </div>
            ))}
          </>
        )}

        {/* Punctuation */}
        {punctuationIssues.length > 0 && (
          <>
            <div className="section-header">
               <h3>ЁЯФд ржмрж┐рж░рж╛ржо ржЪрж┐рж╣рзНржи</h3>
               <span className="section-badge" style={{background: '#fed7aa', color: '#c2410c'}}>{punctuationIssues.length}ржЯрж┐</span>
            </div>
            {punctuationIssues.map((p, i) => (
              <div key={i} className="suggestion-card orange-card" onMouseEnter={() => highlightInWord(p.currentSentence, '#ffedd5')}>
                <div className="wrong-word" style={{color: '#ea580c'}}>тЪая╕П {p.issue}</div>
                <div className="reason">{p.explanation}</div>
                <button onClick={() => replaceInWord(p.currentSentence, p.correctedSentence)} className="suggestion-btn orange-btn">
                  тЬУ {p.correctedSentence}
                </button>
              </div>
            ))}
          </>
        )}
        
         {/* Euphony */}
        {euphonyImprovements.length > 0 && (
          <>
            <div className="section-header">
              <h3>ЁЯО╡ рж╢рзНрж░рзБрждрж┐ржоржзрзБрж░рждрж╛</h3>
               <span className="section-badge" style={{background: '#fce7f3', color: '#be185d'}}>{euphonyImprovements.length}ржЯрж┐</span>
            </div>
            {euphonyImprovements.map((e, i) => (
              <div key={i} className="suggestion-card" style={{borderLeft:'4px solid #db2777'}} onMouseEnter={() => highlightInWord(e.current, '#fce7f3')}>
                 <div className="wrong-word" style={{color: '#db2777'}}>ЁЯО╡ {e.current}</div>
                <div className="reason">{e.reason}</div>
                {e.suggestions.map((s, j) => (
                     <button key={j} onClick={() => replaceInWord(e.current, s)} className="suggestion-btn" style={{background: '#fce7f3', borderColor: '#f9a8d4', color: '#9f1239'}}>
                      тЩк {s}
                    </button>
                ))}
              </div>
            ))}
          </>
        )}
      </div>

      {/* Footer */}
      <div className="footer">
        <p style={{fontSize:'15px', color:'rgba(255,255,255,0.9)', fontWeight:600}}>Developed by: рж╣рж┐ржорж╛ржжрзНрж░рж┐ ржмрж┐рж╢рзНржмрж╛рж╕</p>
        <p style={{fontSize:'12px', color:'rgba(255,255,255,0.7)'}}>ЁЯУЮ +880 9696 196566</p>
      </div>

      {/* --- MODALS --- */}
      
      {/* Settings Modal */}
      {activeModal === 'settings' && (
        <div className="modal-overlay" onClick={() => setActiveModal('none')}>
          <div className="modal-content" onClick={e => e.stopPropagation()}>
            <div className="modal-header settings-header">
              <h3>тЪЩя╕П рж╕рзЗржЯрж┐ржВрж╕</h3>
              <button onClick={() => setActiveModal('none')}>тЬХ</button>
            </div>
            <div className="modal-body">
              <label>ЁЯФС Google Gemini API Key</label>
              <input type="password" value={apiKey} onChange={e => setApiKey(e.target.value)} placeholder="ржЖржкржирж╛рж░ API Key ржПржЦрж╛ржирзЗ ржжрж┐ржи" />
              
              <label>ЁЯдЦ AI Model</label>
              <select value={selectedModel} onChange={e => setSelectedModel(e.target.value)}>
                <option value="gemini-2.5-flash">Gemini 2.5 Flash (рж╕рзЗрж░рж╛)</option>
                <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (ржжрзНрж░рзБрждрждржо)</option>
                <option value="gemini-1.5-pro">Gemini 1.5 Pro (ржЙржЪрзНржЪржорж╛ржи)</option>
                <option value="gemini-1.5-flash">Gemini 1.5 Flash</option>
                <option value="gemini-pro">Gemini Pro</option>
              </select>
              
              <div style={{display:'flex', gap:'10px'}}>
                  <button onClick={saveSettings} className="btn-primary-full">тЬУ рж╕ржВрж░ржХрзНрж╖ржг</button>
                  <button onClick={() => setActiveModal('none')} style={{padding:'12px 20px', background:'#f3f4f6', borderRadius:'10px', border:'none', cursor:'pointer', fontWeight:600}}>ржмрж╛рждрж┐рж▓</button>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Instructions Modal */}
      {activeModal === 'instructions' && (
        <div className="modal-overlay" onClick={() => setActiveModal('none')}>
          <div className="modal-content" onClick={e => e.stopPropagation()}>
            <div className="modal-header instructions-header">
              <h3>ЁЯОп ржмрзНржпржмрж╣рж╛рж░ ржирж┐рж░рзНржжрзЗрж╢рж┐ржХрж╛</h3>
              <button onClick={() => setActiveModal('none')}>тЬХ</button>
            </div>
            <div className="modal-body">
              <ol style={{paddingLeft: '18px', lineHeight: '2', fontSize: '13px'}}>
                <li style={{marginBottom:'10px'}}>тЪЩя╕П рж╕рзЗржЯрж┐ржВрж╕ ржерзЗржХрзЗ API Key ржжрж┐ржи</li>
                <li style={{marginBottom:'10px'}}>тЬНя╕П ржмрж╛ржВрж▓рж╛ ржЯрзЗржХрзНрж╕ржЯ рж▓рж┐ржЦрзБржи ржмрж╛ ржкрзЗрж╕рзНржЯ ржХрж░рзБржи</li>
                <li style={{marginBottom:'10px'}}>ЁЯТм <strong>ржЯрзЛржи</strong> ржЖржЗржХржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржнрж╛ржм ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</li>
                <li style={{marginBottom:'10px'}}>ЁЯУЭ <strong>ржнрж╛рж╖рж╛рж░рзАрждрж┐</strong> ржЖржЗржХржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ рж╕рж╛ржзрзБ/ржЪрж▓рж┐ржд ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</li>
                <li style={{marginBottom:'10px'}}>ЁЯФН "ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи" ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржи</li>
                <li>тЬУ рж╕рж╛ржЬрзЗрж╢ржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржкрзНрж░рждрж┐рж╕рзНржерж╛ржкржи ржХрж░рзБржи</li>
              </ol>
              <div style={{marginTop: '16px', padding: '14px', background: 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)', borderRadius: '10px', border: '2px solid #fbbf24'}}>
                <p style={{fontSize: '12px', color: '#92400e'}}><strong>ЁЯТб ржЯрж┐ржк:</strong> ржЯрзЛржи ржмрж╛ ржнрж╛рж╖рж╛рж░рзАрждрж┐ ржирж┐рж░рзНржмрж╛ржЪржи ржРржЪрзНржЫрж┐ржХред</p>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Tone Modal */}
      {activeModal === 'tone' && (
        <div className="modal-overlay" onClick={() => setActiveModal('none')}>
          <div className="modal-content" onClick={e => e.stopPropagation()}>
            <div className="modal-header tone-header">
              <h3>ЁЯТм ржЯрзЛржи/ржнрж╛ржм ржирж┐рж░рзНржмрж╛ржЪржи</h3>
              <button onClick={() => setActiveModal('none')}>тЬХ</button>
            </div>
            <div className="modal-body">
              {[
                {id: '', icon: 'тЭМ', title: 'ржХрзЛржиржЯрж┐ ржиржпрж╝', desc: 'рж╢рзБржзрзБ ржмрж╛ржирж╛ржи ржУ ржмрзНржпрж╛ржХрж░ржг ржкрж░рзАржХрзНрж╖рж╛'},
                {id: 'formal', icon: 'ЁЯУЛ', title: 'ржЖржирзБрж╖рзНржарж╛ржирж┐ржХ (Formal)', desc: 'ржжрж╛ржкрзНрждрж░рж┐ржХ ржЪрж┐ржарж┐, ржЖржмрзЗржжржи, ржкрзНрж░рждрж┐ржмрзЗржжржи'},
                {id: 'informal', icon: 'ЁЯТм', title: 'ржЕржирж╛ржирзБрж╖рзНржарж╛ржирж┐ржХ (Informal)', desc: 'ржмрзНржпржХрзНрждрж┐ржЧржд ржЪрж┐ржарж┐, ржмрзНрж▓ржЧ, рж╕рзЛрж╢рзНржпрж╛рж▓ ржорж┐ржбрж┐ржпрж╝рж╛'},
                {id: 'professional', icon: 'ЁЯТ╝', title: 'ржкрзЗрж╢рж╛ржжрж╛рж░ (Professional)', desc: 'ржмрзНржпржмрж╕рж╛ржпрж╝рж┐ржХ ржпрзЛржЧрж╛ржпрзЛржЧ, ржХрж░рзНржкрзЛрж░рзЗржЯ'},
                {id: 'friendly', icon: 'ЁЯШК', title: 'ржмржирзНржзрзБрждрзНржмржкрзВрж░рзНржг (Friendly)', desc: 'ржЙрж╖рзНржг, ржЖржирзНрждрж░рж┐ржХ ржпрзЛржЧрж╛ржпрзЛржЧ'},
                {id: 'respectful', icon: 'ЁЯЩП', title: 'рж╕ржорзНржорж╛ржиржЬржиржХ (Respectful)', desc: 'ржмржпрж╝рзЛржЬрзНржпрзЗрж╖рзНржа ржмрж╛ рж╕ржорзНржорж╛ржирж┐ржд ржмрзНржпржХрзНрждрж┐'},
                {id: 'persuasive', icon: 'ЁЯТк', title: 'ржкрзНрж░ржнрж╛ржмрж╢рж╛рж▓рзА (Persuasive)', desc: 'ржорж╛рж░рзНржХрзЗржЯрж┐ржВ, ржмрж┐ржХрзНрж░ржпрж╝, ржкрзНрж░ржЪрж╛рж░ржгрж╛'},
                {id: 'neutral', icon: 'тЪЦя╕П', title: 'ржирж┐рж░ржкрзЗржХрзНрж╖ (Neutral)', desc: 'рж╕ржВржмрж╛ржж, рждржерзНржпржорзВрж▓ржХ рж▓рзЗржЦрж╛'},
                {id: 'academic', icon: 'ЁЯУЪ', title: 'рж╢рж┐ржХрзНрж╖рж╛ржорзВрж▓ржХ (Academic)', desc: 'ржЧржмрзЗрж╖ржгрж╛ ржкрждрзНрж░, ржкрзНрж░ржмржирзНржз'}
              ].map(opt => (
                <div key={opt.id} className={`option-item ${selectedTone === opt.id ? 'selected' : ''}`} onClick={() => {setSelectedTone(opt.id); setActiveModal('none');}}>
                  <div className="opt-icon">{opt.icon}</div>
                  <div style={{flex:1}}>
                    <div className="opt-title">{opt.title}</div>
                    <div className="opt-desc">{opt.desc}</div>
                  </div>
                  {selectedTone === opt.id && <div className="check-mark">тЬУ</div>}
                </div>
              ))}
            </div>
          </div>
        </div>
      )}

      {/* Style Modal */}
      {activeModal === 'style' && (
        <div className="modal-overlay" onClick={() => setActiveModal('none')}>
          <div className="modal-content" onClick={e => e.stopPropagation()}>
            <div className="modal-header style-header">
              <h3>ЁЯУЭ ржнрж╛рж╖рж╛рж░рзАрждрж┐ ржирж┐рж░рзНржмрж╛ржЪржи</h3>
              <button onClick={() => setActiveModal('none')}>тЬХ</button>
            </div>
            <div className="modal-body">
              {[
                {id: 'none', icon: 'тЭМ', title: 'ржХрзЛржиржЯрж┐ ржиржпрж╝', desc: 'рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржорж┐рж╢рзНрж░ржг рж╕ржирж╛ржХрзНрждржХрж░ржг ржЪрж╛рж▓рзБ ржерж╛ржХржмрзЗ'},
                {id: 'sadhu', icon: 'ЁЯУЬ', title: 'рж╕рж╛ржзрзБ рж░рзАрждрж┐', desc: 'ржХрж░рж┐рждрзЗржЫрж┐, ржХрж░рж┐ржпрж╝рж╛ржЫрж┐, рждрж╛рж╣рж╛рж░, ржпрж╛рж╣рж╛'},
                {id: 'cholito', icon: 'ЁЯТм', title: 'ржЪрж▓рж┐ржд рж░рзАрждрж┐', desc: 'ржХрж░ржЫрж┐, ржХрж░рзЗржЫрж┐, рждрж╛рж░, ржпрж╛'}
              ].map(opt => (
                <div key={opt.id} className={`option-item ${selectedStyle === opt.id ? 'selected' : ''}`} onClick={() => {setSelectedStyle(opt.id); setActiveModal('none');}}>
                  <div className="opt-icon">{opt.icon}</div>
                  <div style={{flex:1}}>
                    <div className="opt-title">{opt.title}</div>
                    <div className="opt-desc">{opt.desc}</div>
                  </div>
                  {selectedStyle === opt.id && <div className="check-mark">тЬУ</div>}
                </div>
              ))}
              
               <div style={{padding: '10px', background: 'linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%)', borderRadius: '10px', border: '2px solid #c4b5fd', marginTop: '10px'}}>
                <h4 style={{fontSize: '12px', fontWeight: 'bold', color: '#5b21b6', marginBottom: '6px'}}>ЁЯУЦ ржкрж╛рж░рзНржержХрзНржп</h4>
                <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px', fontSize: '11px'}}>
                  <div>
                    <p style={{fontWeight: 600, color: '#7c3aed', marginBottom: '2px'}}>рж╕рж╛ржзрзБ:</p>
                    <p style={{color: '#6b7280'}}>ржХрж░рж┐рждрзЗржЫрж┐, рждрж╛рж╣рж╛рж░</p>
                  </div>
                  <div>
                    <p style={{fontWeight: 600, color: '#0d9488', marginBottom: '2px'}}>ржЪрж▓рж┐ржд:</p>
                    <p style={{color: '#6b7280'}}>ржХрж░ржЫрж┐, рждрж╛рж░</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      )}

    </div>
  );
}

// ----------------------------------------------------------------------
// INITIALIZE OFFICE & REACT ENTRY POINT (Fixes TS6133)
// ----------------------------------------------------------------------
Office.onReady(() => {
  const rootElement = document.getElementById('root');
  if (rootElement) {
    const root = ReactDOM.createRoot(rootElement);
    root.render(<App />);
  }
});
